{"ast":null,"code":"/*\n * @Author: 王志伟\n * @Date: 2019-07-19 16:39:16\n * @Last Modified by: 王志伟\n * @Last Modified time: 2019-07-26 14:17:34\n * @Content: 生成海报。其中只更改了createPoster函数，添加了createCardPoster函数，其他与原代码相同。\n */\nimport * as SVG from 'svg.js';\nimport $ from 'jquery';\n\nfunction csv2array(data, delimeter) {\n  // Retrieve the delimeter\n  if (delimeter === undefined) delimeter = ',';\n  if (delimeter && delimeter.length > 1) delimeter = ','; // initialize variables\n\n  var newline = '\\n';\n  var eof = '';\n  var i = 0;\n  var c = data.charAt(i);\n  var row = 0;\n  var col = 0;\n  var array = [];\n\n  while (c !== eof) {\n    // skip whitespaces\n    while (c === ' ' || c === '\\t' || c === '\\r') {\n      c = data.charAt(++i); // read next char\n    } // get value\n\n\n    var value = \"\";\n\n    if (c === '\"') {\n      // value enclosed by double-quotes\n      c = data.charAt(++i);\n\n      do {\n        if (c !== '\"') {\n          // read a regular character and go to the next character\n          value += c;\n          c = data.charAt(++i);\n        }\n\n        if (c === '\"') {\n          // check for escaped double-quote\n          var cnext = data.charAt(i + 1);\n\n          if (cnext === '\"') {\n            // this is an escaped double-quote.\n            // Add a double-quote to the value, and move two characters ahead.\n            value += '\"';\n            i += 2;\n            c = data.charAt(i);\n          }\n        }\n      } while (c !== eof && c !== '\"');\n\n      if (c === eof) {\n        throw \"Unexpected end of data, double-quote expected\";\n      }\n\n      c = data.charAt(++i);\n    } else {\n      // value without quotes\n      while (c !== eof && c !== delimeter && c !== newline && c !== ' ' && c !== '\\t' && c !== '\\r') {\n        value += c;\n        c = data.charAt(++i);\n      }\n    } // add the value to the array\n\n\n    if (array.length <= row) array.push([]);\n    array[row].push(value); // skip whitespaces\n\n    while (c === ' ' || c === '\\t' || c === '\\r') {\n      c = data.charAt(++i);\n    } // go to the next row or column\n\n\n    if (c === delimeter) {\n      // to the next column\n      col = col + 1;\n    } else if (c === newline) {\n      // to the next row\n      col = 0;\n      row++;\n    } else if (c !== eof) {\n      // unexpected character\n      throw \"Delimiter expected after character \" + i;\n    } // go to the next character\n\n\n    c = data.charAt(++i);\n  }\n\n  return array;\n}\n\nfunction createRGBfromHSV(h, s, v) {\n  var r, g, b, i, f, p, q, t;\n\n  if (arguments.length === 1) {\n    s = h.s;\n    v = h.v;\n    h = h.h;\n  }\n\n  i = Math.floor(h * 6);\n  f = h * 6 - i;\n  p = v * (1 - s);\n  q = v * (1 - f * s);\n  t = v * (1 - (1 - f) * s);\n\n  switch (i % 6) {\n    case 0:\n      r = v;\n      g = t;\n      b = p;\n      break;\n\n    case 1:\n      r = q;\n      g = v;\n      b = p;\n      break;\n\n    case 2:\n      r = p;\n      g = v;\n      b = t;\n      break;\n\n    case 3:\n      r = p;\n      g = q;\n      b = v;\n      break;\n\n    case 4:\n      r = t;\n      g = p;\n      b = v;\n      break;\n\n    case 5:\n      r = v;\n      g = p;\n      b = q;\n      break;\n\n    default:\n      break;\n  }\n\n  return {\n    r: Math.round(r * 255),\n    g: Math.round(g * 255),\n    b: Math.round(b * 255)\n  };\n}\n\nfunction getNumberInNormalDistribution(std_dev) {\n  var offset = randomNormalDistribution() * std_dev;\n  return offset;\n}\n\nfunction randomNormalDistribution() {\n  var u = 0.0,\n      v = 0.0,\n      w = 0.0,\n      c = 0.0;\n\n  do {\n    u = Math.random() * 2 - 1.0;\n    v = Math.random() * 2 - 1.0;\n    w = u * u + v * v;\n  } while (w === 0.0 || w >= 1.0);\n\n  c = Math.sqrt(-2 * Math.log(w) / w);\n  return u * c;\n}\n\nfunction generateColor(colors, number, std_dev) {\n  var numberOfColor = colors.length;\n  var colorList = [];\n\n  for (var n = 0; n < colors.length; n++) {\n    var hList = [],\n        sList = [],\n        vList = [];\n    var k = number;\n\n    for (k; k > 0; k--) {\n      var offset = getNumberInNormalDistribution(std_dev);\n      var new_h = colors[n][0] + offset;\n      var new_s = colors[n][1] + offset;\n      var new_v = colors[n][2] + offset;\n\n      if (new_h < 0) {\n        new_h = 360 + new_h;\n      } else if (new_h > 360) {\n        new_h = new_h - 360;\n      }\n\n      if (new_s < 0) {\n        new_s = new_s * -1;\n      } else if (new_s > 100) {\n        new_s = 200 - new_s;\n      }\n\n      if (new_v < 0) {\n        new_v = new_v * -1;\n      } else if (new_v > 100) {\n        new_v = 200 - new_v;\n      }\n\n      hList.push(new_h);\n      sList.push(new_s);\n      vList.push(new_v);\n    }\n\n    colorList.push([hList, sList, vList]);\n  }\n\n  var rgbList = [];\n  let hIndex, sIndex, vIndex;\n\n  for (hIndex in colorList[0][0]) {\n    for (sIndex in colorList[0][1]) {\n      for (vIndex in colorList[0][2]) {\n        var RGBs = [];\n\n        for (n = 0; n < numberOfColor; n++) {\n          RGBs.push(createRGBfromHSV(colorList[n][0][hIndex] / 360, colorList[n][1][sIndex] / 100, colorList[n][2][vIndex] / 100));\n        }\n\n        rgbList.push(RGBs);\n      }\n    }\n  }\n\n  return rgbList;\n}\n\nvar posterIndex = 0;\nvar backgroundPalette = [],\n    elementPalettePure = [],\n    elementPaletteGrad = []; //face_color/nose,ear_color/neck_color\n\nvar skinPalette = [[{\n  r: 252,\n  g: 234,\n  b: 202\n}, {\n  r: 240,\n  g: 216,\n  b: 182\n}, {\n  r: 230,\n  g: 203,\n  b: 159\n}], [{\n  r: 245,\n  g: 219,\n  b: 174\n}, {\n  r: 232,\n  g: 202,\n  b: 160\n}, {\n  r: 218,\n  g: 189,\n  b: 141\n}], [{\n  r: 228,\n  g: 196,\n  b: 142\n}, {\n  r: 214,\n  g: 178,\n  b: 133\n}, {\n  r: 204,\n  g: 166,\n  b: 113\n}]];\nvar colorRanNumber = 10,\n    colorRanRange = 5;\nbackgroundPalette.push(generateColor([[0, 0, 100]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[0, 0, 92]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[0, 0, 21]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[164, 15, 72]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[248, 36, 58]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[39, 49, 98], [331, 60, 96]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[328, 33, 100], [213, 26, 100]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[187, 43, 100], [325, 21, 100]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[171, 49, 91], [223, 44, 89]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[336, 42, 100], [222, 93, 60]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[36, 32, 99], [188, 52, 95]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[135, 64, 91], [259, 67, 96]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[8, 25, 98], [188, 51, 85]], colorRanNumber, colorRanRange));\ncolorRanRange = 8;\nelementPalettePure.push(generateColor([[0, 0, 100]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[0, 0, 84]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[77, 13, 21]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[252, 59, 100]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[154, 37, 94]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[339, 40, 100]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[47, 78, 98]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[296, 59, 99]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[187, 45, 91]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[347, 78, 100]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[0, 0, 93], [0, 0, 47]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[51, 19, 100], [334, 45, 100]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[58, 83, 100], [326, 80, 95]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[24, 49, 100], [274, 79, 91]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[135, 64, 91], [62, 81, 96]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[135, 64, 91], [259, 67, 96]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[352, 42, 99], [183, 75, 95]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[319, 86, 89], [190, 46, 93]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[181, 80, 93], [259, 67, 96]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[207, 86, 89], [273, 82, 57]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[30, 11, 93], [23, 44, 74]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[187, 43, 100], [325, 21, 100]], colorRanNumber, colorRanRange)); //Rotation\n\nvar tRotation_1 = [0, 30, 60, 90, 120, 150, 180],\n    tRotation_2 = [0, 36, 72, 108, 144, 180],\n    tRotation_3 = [0, 30, 60, 90, 120, 150, 180],\n    tRotation_4 = [0, 180],\n    tRotation_5 = [0, 45, 90, 135, 180],\n    tRotation_6 = [0, 60, 90, 150, 180],\n    tRotation_7 = [0, 30, 60, 90, 120, 150, 180],\n    sRotation_1 = [0, 30, 60, 90, 120, 150, 180],\n    sRotation_2 = [0, 45, 90, 135, 180],\n    cRotation = [0, 45, 90, 135, 180]; //Layout\n\nvar width = 1080 / 4,\n    height = 1314 / 4;\nvar fontSizeSmall = 5,\n    fontSizeMid = 8,\n    fontSizeLarge = 10; //resize\n\nwidth /= 2;\nheight /= 2;\nfontSizeSmall /= 2;\nfontSizeMid /= 2;\nfontSizeLarge /= 2;\nvar widthSegments = 15,\n    heightSegments = 20; //position for laying texts\n\nvar textIntersection = [];\ntextIntersection[0] = [width / widthSegments * 2, height / heightSegments * 2, 0];\ntextIntersection[1] = [width / widthSegments * 17, height / heightSegments * 2, 0];\ntextIntersection[2] = [width / widthSegments * 2, height / heightSegments * 32, 0];\ntextIntersection[3] = [width / widthSegments * 17, height / heightSegments * 32, 0];\nvar coreIntersections = [],\n    normalIntersections = []; //center\n\ncoreIntersections[0] = [width / 2, height / 2, 0]; //three-folds\n\ncoreIntersections[1] = [width / 3, height / 3, 0];\ncoreIntersections[2] = [width / 3, height * 2 / 3, 0];\ncoreIntersections[3] = [width * 2 / 3, height / 3, 0];\ncoreIntersections[4] = [width * 2 / 3, height * 2 / 3, 0]; //squre-intersection\n\ncoreIntersections[5] = calIntersection(height / width, 0, -width / height, width * width / height); //coreIntersections[5].push(Math.atan(-width/height)*90)\n\ncoreIntersections[5].push(0);\ncoreIntersections[6] = calIntersection(height / width, 0, -width / height, height); //coreIntersections[6].push(Math.atan(-width/height)*90)\n\ncoreIntersections[6].push(0);\ncoreIntersections[7] = calIntersection(-height / width, height, width / height, height - width * width / height); //coreIntersections[7].push(Math.atan(width/height)*90)\n\ncoreIntersections[7].push(0);\ncoreIntersections[8] = calIntersection(-height / width, height, width / height, 0); //coreIntersections[8].push(Math.atan(width/height)*90)\n\ncoreIntersections[8].push(0);\n\nfunction calIntersection(a1, b1, a2, b2) {\n  var interPoint = []; //x\n\n  interPoint[0] = (b2 - b1) / (a1 - a2); //y\n\n  interPoint[1] = a1 * interPoint[0] + b1;\n  return interPoint;\n} // Draw white points\n// var widthGap = width/widthSegments;\n\n\nvar heightGap = height / heightSegments; // var lineStyle_2 = {width: 0.5 ,color: '#C1BAC6'}\n\nfor (var i = 1; i < widthSegments; i++) {\n  var x = heightGap * i; //draw.line(x,0,x,height).stroke(lineStyle_2)\n  //calculate interaction with horizontal lines\n\n  normalIntersections.push([x, x * height / width, Math.atan(height / width) * 90]);\n  normalIntersections.push([x, x * (-height / width) + height, Math.atan(-height / width) * 90]);\n  normalIntersections.push([x, x * (-width / height) + width * width / height, Math.atan(-width / height) * 90]);\n  normalIntersections.push([x, x * (-width / height) + height, Math.atan(-width / height) * 90]);\n  normalIntersections.push([x, x * width / height + height - width * width / height, Math.atan(width / height) * 90]);\n  normalIntersections.push([x, x * width / height, Math.atan(width / height) * 90]);\n}\n\nfor (var j = 1; j < heightSegments; j++) {\n  var y = heightGap * j; //draw.line(0,y,width,y).stroke(lineStyle_2)\n\n  normalIntersections.push([y / (height / width), y, Math.atan(height / width) * 90]);\n  normalIntersections.push([(y - height) / (-height / width), y, Math.atan(-height / width) * 90]);\n\n  if (y <= width * width / height) {\n    normalIntersections.push([(y - width * width / height) / (-width / height), y, Math.atan(-width / height) * 90]);\n    normalIntersections.push([y / (width / height), y, Math.atan(width / height) * 90]);\n  }\n\n  if (y >= height - width * width / height && y < height) {\n    normalIntersections.push([(y - height) / (-width / height), y, Math.atan(-width / height) * 90]);\n    normalIntersections.push([(y - height + width * width / height) / (width / height), y, Math.atan(width / height) * 90]);\n  }\n} // ==================================================================\n\n\nfunction loadxmlDoc(file) {\n  let xmlDoc;\n\n  try {\n    //IE\n    xmlDoc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n  } catch (e) {\n    ////Firefox, Mozilla, Opera, etc\n    xmlDoc = document.implementation.createDocument(\"\", \"\", null);\n  }\n\n  try {\n    xmlDoc.async = false;\n    xmlDoc.load(file);\n  } catch (e) {\n    // for Chrome\n    var xmlhttp = new window.XMLHttpRequest(); // console.log(xmlhttp);\n\n    xmlhttp.open(\"GET\", file, false);\n    xmlhttp.send(null);\n    xmlDoc = xmlhttp.responseXML.documentElement; // Sconsole.log(xmlDoc);\n  }\n\n  return xmlDoc;\n}\n\nvar ob = loadxmlDoc(\"/all.xml\");\nvar svg = ob.getElementsByTagName(\"svg\"); //create all possible shapes in the canvas\n\nfunction createShapes(cList, rList, tList, pList, draw) {\n  for (var i = 0; i < svg.length; i++) {\n    var shape = draw.group();\n    let data;\n\n    if (svg[i].getElementById('triangle')) {\n      data = svg[i].getElementById('triangle').childNodes[1];\n      var transform = svg[i].getElementById('triangle').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',');\n      var point = svg[i].getElementById('point');\n      var index = parseInt(data.id.split(\"/\")[1]) + 4 + (parseInt(data.id.split(\"/\")[2]) + 4) * 9; // console.log(data.id)\n      //check if the element has transform data\n\n      if (svg[i].getElementById(data.id).getAttribute(\"transform\")) {\n        var elementTransform = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(','); // console.log(elementTransform)\n\n        transform[0] = parseFloat(transform[0]) + parseFloat(elementTransform[0]);\n        transform[1] = parseFloat(transform[1]) + parseFloat(elementTransform[1]);\n\n        if (svg[i].getElementById(data.id).getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n          var scaleValue = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',');\n          shape.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]));\n        }\n      } // set attributes of shape\n\n\n      if (point) {\n        var cx = parseFloat(point.getAttribute(\"x\"));\n        var cy = parseFloat(point.getAttribute(\"y\"));\n        shape.attr({\n          \"name\": data.id,\n          \"cx\": cx,\n          \"cy\": cy,\n          \"transform\": \"translate(\" + (parseFloat(transform[0]) - cx) + \",\" + (parseFloat(transform[1]) - cy) + \")\",\n          \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n          \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n        });\n      } else {\n        shape.attr({\n          \"name\": data.id,\n          \"transform\": \"translate(\" + (parseFloat(transform[0]) - parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) - parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n          \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n          \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n        });\n      } // set content of shape\n\n\n      if (svg[i].getElementsByTagName('path')[0]) {\n        shape.path(svg[i].getElementsByTagName('path')[0].getAttribute(\"d\"));\n      } else if (svg[i].getElementsByTagName('polygon')[0]) {\n        shape.add(draw.polygon().attr(\"points\", svg[i].getElementsByTagName('polygon')[0].getAttribute(\"points\")));\n      }\n\n      draw.defs().add(shape);\n      tList[index] = shape;\n    } else if (svg[i].getElementById('square')) {\n      data = svg[i].getElementById('square').childNodes[1];\n      var transform = svg[i].getElementById('square').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',');\n      var point = svg[i].getElementById('point');\n      var index = parseInt(data.id.split(\"/\")[1]) + 4 + (parseInt(data.id.split(\"/\")[2]) + 4) * 9; //check if the element has transform data\n\n      if (svg[i].getElementById(data.id).getAttribute(\"transform\")) {\n        var elementTransform = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(','); // console.log(elementTransform)\n\n        transform[0] = parseFloat(transform[0]) + parseFloat(elementTransform[0]);\n        transform[1] = parseFloat(transform[1]) + parseFloat(elementTransform[1]);\n\n        if (svg[i].getElementById(data.id).getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n          var scaleValue = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',');\n          shape.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]));\n        }\n      } // set attributes of shape\n\n\n      if (point) {\n        var cx = parseFloat(point.getAttribute(\"x\"));\n        var cy = parseFloat(point.getAttribute(\"y\"));\n        shape.attr({\n          \"name\": data.id,\n          \"cx\": cx,\n          \"cy\": cy,\n          \"transform\": \"translate(\" + (parseFloat(transform[0]) - cx) + \",\" + (parseFloat(transform[1]) - cy) + \")\",\n          \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n          \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n        });\n      } else {\n        shape.attr({\n          \"name\": data.id,\n          \"transform\": \"translate(\" + (parseFloat(transform[0]) - parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) - parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n          \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n          \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n        });\n      } // set content of shape\n\n\n      if (svg[i].getElementsByTagName('path')[0]) {\n        shape.path(svg[i].getElementsByTagName('path')[0].getAttribute(\"d\"));\n      } else if (svg[i].getElementsByTagName('polygon')[0]) {\n        shape.add(draw.polygon().attr(\"points\", svg[i].getElementsByTagName('polygon')[0].getAttribute(\"points\")));\n      }\n\n      draw.defs().add(shape);\n      rList[index] = shape;\n    } else if (svg[i].getElementById('circular')) {\n      data = svg[i].getElementById('circular').childNodes[1];\n      var transform = svg[i].getElementById('circular').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',');\n      var point = svg[i].getElementById('point');\n      var index = parseInt(data.id.split(\"/\")[1]) + 4 + (parseInt(data.id.split(\"/\")[2]) + 4) * 9; //check if the element has transform data\n\n      if (svg[i].getElementById(data.id).getAttribute(\"transform\")) {\n        var elementTransform = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(','); // console.log(elementTransform)\n\n        transform[0] = parseFloat(transform[0]) + parseFloat(elementTransform[0]);\n        transform[1] = parseFloat(transform[1]) + parseFloat(elementTransform[1]);\n\n        if (svg[i].getElementById(data.id).getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n          var scaleValue = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',');\n          shape.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]));\n        }\n      } // set attributes of shape\n\n\n      if (point) {\n        var cx = parseFloat(point.getAttribute(\"x\"));\n        var cy = parseFloat(point.getAttribute(\"y\"));\n        shape.attr({\n          \"name\": data.id,\n          \"cx\": cx,\n          \"cy\": cy,\n          \"transform\": \"translate(\" + (parseFloat(transform[0]) - cx) + \",\" + (parseFloat(transform[1]) - cy) + \")\",\n          \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n          \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n        });\n      } else {\n        shape.attr({\n          \"name\": data.id,\n          \"transform\": \"translate(\" + (parseFloat(transform[0]) - parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) - parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n          \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n          \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n        });\n      } // set content of shape\n\n\n      if (svg[i].getElementsByTagName('path')[0]) {\n        shape.path(svg[i].getElementsByTagName('path')[0].getAttribute(\"d\"));\n      } else if (svg[i].getElementsByTagName('ellipse')[0]) {\n        shape.add(draw.ellipse().attr({\n          \"cx\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"cx\"),\n          \"cy\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"cy\"),\n          \"rx\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"rx\"),\n          \"ry\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"ry\")\n        }));\n      } else if (svg[i].getElementsByTagName('circle')[0]) {\n        shape.add(draw.circle().attr({\n          \"cx\": svg[i].getElementsByTagName('circle')[0].getAttribute(\"cx\"),\n          \"cy\": svg[i].getElementsByTagName('circle')[0].getAttribute(\"cy\"),\n          \"r\": svg[i].getElementsByTagName('circle')[0].getAttribute(\"r\")\n        }));\n      }\n\n      draw.defs().add(shape);\n      cList[index] = shape;\n    } else if (svg[i].getElementById('people')) {\n      data = svg[i].getElementById('people').childNodes[1];\n      var transform = svg[i].getElementById('people').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',');\n      shape.attr({\n        \"name\": data.id,\n        \"transform\": \"translate(\" + (parseFloat(transform[0]) + parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) + parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n        \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n        \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n      });\n      var transformHead = svg[i].getElementById('head').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',');\n      var head = draw.group().translate(parseFloat(transformHead[0]), parseFloat(transformHead[1])).addClass(\"head\");\n      var headPaths = svg[i].getElementById('head').getElementsByTagName(\"path\"); // console.log(headPaths)\n\n      for (var index = 0; index < headPaths.length; index++) {\n        var newPath = draw.path(headPaths[index].getAttribute(\"d\"));\n        if (headPaths[index].getAttribute(\"id\") === \"nose\" || headPaths[index].getAttribute(\"id\") === \"ear\" || headPaths[index].getAttribute(\"id\") === \"ear2\") newPath.addClass(\"nose\");\n        if (headPaths[index].getAttribute(\"id\") === \"shadow\") newPath.addClass(\"shadow\");\n        if (headPaths[index].getAttribute(\"id\") === \"face\" || headPaths[index].getAttribute(\"id\") === \"neck\") newPath.addClass(\"skin\");\n\n        if (headPaths[index].getAttribute(\"fill\")) {\n          var color = headPaths[index].getAttribute(\"fill\");\n          newPath.fill(color);\n        }\n\n        if (headPaths[index].getAttribute(\"transform\")) {\n          if (headPaths[index].getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n            var scaleValue = headPaths[index].getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',');\n            newPath.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]));\n          }\n\n          if (headPaths[index].getAttribute(\"transform\").indexOf(\"rotate\") > 0) {\n            var rotateValue = headPaths[index].getAttribute(\"transform\").match(/rotate.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0];\n            newPath.rotate(parseFloat(rotateValue));\n          }\n        }\n\n        head.add(newPath);\n      }\n\n      var headCircles = svg[i].getElementById('head').getElementsByTagName(\"ellipse\");\n\n      for (var index = 0; index < headCircles.length; index++) {\n        var newCircle = draw.ellipse().attr({\n          \"cx\": headCircles[index].getAttribute(\"cx\"),\n          \"cy\": headCircles[index].getAttribute(\"cy\"),\n          \"rx\": headCircles[index].getAttribute(\"rx\"),\n          \"ry\": headCircles[index].getAttribute(\"ry\")\n        });\n\n        if (headCircles[index].getAttribute(\"fill\")) {\n          var color = headCircles[index].getAttribute(\"fill\");\n          newCircle.fill(color);\n        }\n\n        if (headCircles[index].getAttribute(\"transform\")) {\n          if (headCircles[index].getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n            var scaleValue = headCircles[index].getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',');\n            newCircle.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]));\n          }\n\n          if (headCircles[index].getAttribute(\"transform\").indexOf(\"rotate\") > 0) {\n            var rotateValue = headCircles[index].getAttribute(\"transform\").match(/rotate.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0];\n            newCircle.rotate(parseFloat(rotateValue));\n          }\n        }\n\n        head.add(newCircle);\n      }\n\n      var arm = svg[i].getElementById('arm');\n      var newArm = draw.path(arm.getAttribute(\"d\")).fill(arm.getAttribute(\"fill\")).addClass(\"skin\");\n      var clothes = svg[i].getElementById('clothes');\n      var newClothes = draw.path(clothes.getAttribute(\"d\")).addClass(\"clothes\");\n      var pattern = svg[i].getElementById('pattern').getElementsByTagName(\"path\")[0];\n      var newPattern = draw.path(pattern.getAttribute(\"d\")).addClass('logo');\n      var transform = svg[i].getElementById('pattern').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',');\n      var color = svg[i].getElementById('pattern').getAttribute(\"fill\");\n      newPattern.attr({\n        \"transform\": \"translate(\" + parseFloat(transform[0]) + \",\" + parseFloat(transform[1]) + \")\"\n      });\n      newPattern.fill(color);\n      shape.add(head);\n      shape.add(newArm);\n      shape.add(newClothes);\n      shape.add(newPattern);\n      draw.defs().add(shape);\n      pList.push(shape);\n    }\n  }\n}\n\nvar drawList = []; // var _draw = SVG('postContainer').size(width, height)\n// var _circleList = [], _rectList = [], _triList = [], _peopleList = []\n// createShapes(_circleList,_rectList,_triList,_peopleList,_draw)\n\nvar _circleList = [],\n    _rectList = [],\n    _triList = [],\n    _peopleList = []; //Define the number of deatures for each shape\n// const NUM_SHAPE_FEATURES=15,\n// \t  MAX_ELEMENTS = 18,\n// \t  NUM_PEOPLE_FEATURES = 17,\n// \t  NUM_TEXT_FEATURES =1,\n// \t  NUM_BG_FEATURES = 6;\n\nconst NUM_ELEMENT_TYPE = 3,\n      NUM_ELEMENT_X = 9,\n      NUM_ELEMENT_Y = 9;\n\nfunction rotate(shape, index) {\n  var randomRotation = index;\n  var shapeName = shape.node.attributes.name.nodeValue.split(\"/\");\n  var rotationAngel;\n\n  if (shapeName[0] === \"t\") {\n    if (parseInt(shapeName[1]) === -4) {\n      rotationAngel = tRotation_1[parseInt(tRotation_1.length * randomRotation)];\n    } else if (parseInt(shapeName[1]) === -3) {\n      rotationAngel = tRotation_2[parseInt(tRotation_2.length * randomRotation)];\n    } else if (parseInt(shapeName[1]) === -2 || parseInt(shapeName[1]) === -1 || parseInt(shapeName[1]) === 0) {\n      rotationAngel = tRotation_3[parseInt(tRotation_3.length * randomRotation)];\n    } else if (parseInt(shapeName[1]) === 1) {\n      rotationAngel = tRotation_4[parseInt(tRotation_4.length * randomRotation)];\n    } else if (parseInt(shapeName[1]) === 2) {\n      rotationAngel = tRotation_5[parseInt(tRotation_5.length * randomRotation)];\n    } else if (parseInt(shapeName[1]) === 3) {\n      rotationAngel = tRotation_6[parseInt(tRotation_6.length * randomRotation)];\n    } else if (parseInt(shapeName[1]) === 4) {\n      rotationAngel = tRotation_7[parseInt(tRotation_7.length * randomRotation)];\n    }\n  } //\n  else if (shapeName[0] === \"s\") {\n      if (parseInt(shapeName[1]) >= -4 && parseInt(shapeName[1]) <= -1) {\n        rotationAngel = sRotation_1[parseInt(sRotation_1.length * randomRotation)];\n      } else if (parseInt(shapeName[1]) >= 0 && parseInt(shapeName[1]) <= 4) {\n        rotationAngel = sRotation_2[parseInt(sRotation_2.length * randomRotation)];\n      }\n    } else if (shapeName[0] === \"c\") {\n      rotationAngel = cRotation[parseInt(cRotation.length * randomRotation)];\n    }\n\n  if (shape.attr(\"cx\") && shape.attr(\"cy\")) {\n    shape.rotate(rotationAngel, shape.attr(\"cx\"), shape.attr(\"cy\"));\n  } else {\n    shape.rotate(rotationAngel);\n  }\n\n  return randomRotation;\n} // var div = document.createElement(\"div\");\n// div.setAttribute(\"id\", \"container\");\n// 被选中的海报\n\n\nvar choosed = null; // 生成海报，并为每一张海报添加click函数\n\nfunction createPoster(csvdata, num) {\n  var subdiv = document.createElement(\"div\");\n  subdiv.setAttribute(\"id\", \"poster\" + num);\n  subdiv.setAttribute(\"class\", \"poster\");\n  div.appendChild(subdiv);\n  document.body.appendChild(div); // console.log(pnt.state);\n\n  var draw = SVG('poster' + num).size(width, height);\n\n  var circleList = _circleList.concat(),\n      rectList = _rectList.concat(),\n      triList = _triList.concat();\n\n  var shapeList = triList.concat(rectList, circleList);\n  var bgGradient = draw.gradient('linear', function (stop) {\n    var bgHSV = csvdata[csvdata.length - 1];\n    stop.at(0, createRGBfromHSV(bgHSV.data[0], bgHSV.data[1], bgHSV.data[2]));\n    stop.at(1, createRGBfromHSV(bgHSV.data[3], bgHSV.data[4], bgHSV.data[5]));\n  });\n  bgGradient.from(\"0%\", \"0%\").to(\"0%\", \"100%\");\n  draw.rect(width, height).fill(bgGradient); // let start = new Date().getTime();\n\n  for (var i = 0; i < csvdata.length; i++) {\n    if (csvdata[i].name === \"element\") {\n      var shapeNormalX = Math.round((NUM_ELEMENT_TYPE - 1) * csvdata[i].data[0]),\n          shapeNormalY = Math.round((NUM_ELEMENT_X - 1) * csvdata[i].data[1]),\n          shapeNormalZ = Math.round((NUM_ELEMENT_Y - 1) * csvdata[i].data[2]);\n      var elementColor = draw.gradient('linear', function (stop) {\n        stop.at(0, createRGBfromHSV(csvdata[i].data[7], csvdata[i].data[8], csvdata[i].data[9]));\n        stop.at(1, createRGBfromHSV(csvdata[i].data[10], csvdata[i].data[11], csvdata[i].data[12]));\n      });\n      elementColor.from(\"0%\", \"0%\").to(\"0%\", \"100%\"); // console.log(shapeList)\n      //console.log(shapeNormalX,shapeNormalY,shapeNormalZ,shapeNormalX*NUM_ELEMENT_X*NUM_ELEMENT_Y+NUM_ELEMENT_X*shapeNormalY+shapeNormalZ)\n\n      var shapeNormal = shapeList[shapeNormalX * NUM_ELEMENT_X * NUM_ELEMENT_Y + NUM_ELEMENT_X * shapeNormalY + shapeNormalZ].clone();\n      var shapeScale = Math.sqrt(width * height * csvdata[i].data[3] / (shapeNormal.width() * shapeNormal.height()));\n      draw.use(shapeNormal); // console.log(width*csvdata[i].data[4],height*csvdata[i].data[5],shapeScale,parseFloat(csvdata[i].data[13]))\n\n      shapeNormal.dx(width * csvdata[i].data[4]).dy(height * csvdata[i].data[5]);\n      rotate(shapeNormal, csvdata[i].data[6]);\n      shapeNormal.scale(shapeScale, shapeScale).fill(elementColor).opacity(parseFloat(csvdata[i].data[13]));\n    }\n  } // console.log('for:')\n  // console.log(new Date().getTime()-start);\n\n\n  drawList.push(draw);\n  draw.attr('num', num);\n  draw.click(function () {\n    document.getElementById(\"audio-click\").play(); // 点击海报则放大显示\n\n    document.getElementById('chooseposter').style.display = 'block';\n    document.getElementById('overlay0').style.display = 'block';\n    if (choosed === null) choosed = SVG(\"choosed\").fill('#0f4');\n    choosed.svg(draw.svg());\n    choosed.attr({\n      'num': num\n    });\n    choosed.scale(4.92);\n    choosed.translate(1294, 1559); // pnt.setState({\n    //     num: draw.attr('num')\n    // });\n    // 添加放大动画\n\n    $(\"#chooseposter\").addClass(\"choose-poster-ani\");\n  });\n}\n\nfunction setChoosedNull() {\n  choosed = null;\n} // 生成“输入名字”页面的卡片上的海报\n\n\nfunction createCardPoster(csvdata) {\n  width *= 4.92;\n  height *= 4.92;\n  fontSizeSmall *= 4.92;\n  fontSizeMid *= 4.92;\n  fontSizeLarge *= 4.92;\n  var draw = SVG('cardPoster').size(width, height); // var circleList = _circleList.concat(), rectList = _rectList.concat(), triList = _triList.concat(), peopleList = _peopleList.concat()\n\n  var circleList = [],\n      rectList = [],\n      triList = [],\n      peopleList = [];\n  createShapes(circleList, rectList, triList, peopleList, draw);\n  var shapeList = triList.concat(rectList, circleList);\n  var bgGradient = draw.gradient('linear', function (stop) {\n    var bgHSV = csvdata[csvdata.length - 1];\n    stop.at(0, createRGBfromHSV(bgHSV.data[0], bgHSV.data[1], bgHSV.data[2]));\n    stop.at(1, createRGBfromHSV(bgHSV.data[3], bgHSV.data[4], bgHSV.data[5]));\n  });\n  bgGradient.from(\"0%\", \"0%\").to(\"0%\", \"100%\");\n  draw.rect(width, height).fill(bgGradient); // let start = new Date().getTime();\n\n  for (var i = 0; i < csvdata.length; i++) {\n    if (csvdata[i].name === \"element\") {\n      var shapeNormalX = Math.round((NUM_ELEMENT_TYPE - 1) * csvdata[i].data[0]),\n          shapeNormalY = Math.round((NUM_ELEMENT_X - 1) * csvdata[i].data[1]),\n          shapeNormalZ = Math.round((NUM_ELEMENT_Y - 1) * csvdata[i].data[2]);\n      var elementColor = draw.gradient('linear', function (stop) {\n        stop.at(0, createRGBfromHSV(csvdata[i].data[7], csvdata[i].data[8], csvdata[i].data[9]));\n        stop.at(1, createRGBfromHSV(csvdata[i].data[10], csvdata[i].data[11], csvdata[i].data[12]));\n      });\n      elementColor.from(\"0%\", \"0%\").to(\"0%\", \"100%\"); // console.log(shapeList)\n      //console.log(shapeNormalX,shapeNormalY,shapeNormalZ,shapeNormalX*NUM_ELEMENT_X*NUM_ELEMENT_Y+NUM_ELEMENT_X*shapeNormalY+shapeNormalZ)\n\n      var shapeNormal = shapeList[shapeNormalX * NUM_ELEMENT_X * NUM_ELEMENT_Y + NUM_ELEMENT_X * shapeNormalY + shapeNormalZ].clone();\n      var shapeScale = Math.sqrt(width * height * csvdata[i].data[3] / (shapeNormal.width() * shapeNormal.height()));\n      draw.use(shapeNormal); // console.log(width*csvdata[i].data[4],height*csvdata[i].data[5],shapeScale,parseFloat(csvdata[i].data[13]))\n\n      shapeNormal.dx(width * csvdata[i].data[4]).dy(height * csvdata[i].data[5]);\n      rotate(shapeNormal, csvdata[i].data[6]);\n      shapeNormal.scale(shapeScale, shapeScale).fill(elementColor).opacity(parseFloat(csvdata[i].data[13]));\n    }\n  }\n}\n\nvar posterList = [];\nvar div; // 获取到服务器返回的csv文件后的回调函数\n\nfunction getDataCallback(data) {\n  // $.get(\"/test.csv\",function(data){\n  // console.log(data);\n  var features = csv2array(data);\n  console.log(features);\n\n  for (var i = 0; i < features.length; i++) {\n    var element = {\n      \"data\": features[i].slice(0, 15),\n      \"index\": features[i][14],\n      \"name\": \"element\"\n    },\n        element2 = {\n      \"data\": features[i].slice(15, 30),\n      \"index\": features[i][29],\n      \"name\": \"element\"\n    },\n        element3 = {\n      \"data\": features[i].slice(30, 45),\n      \"index\": features[i][44],\n      \"name\": \"element\"\n    },\n        element4 = {\n      \"data\": features[i].slice(45, 60),\n      \"index\": features[i][59],\n      \"name\": \"element\"\n    },\n        element5 = {\n      \"data\": features[i].slice(60, 75),\n      \"index\": features[i][74],\n      \"name\": \"element\"\n    },\n        element6 = {\n      \"data\": features[i].slice(75, 90),\n      \"index\": features[i][89],\n      \"name\": \"element\"\n    },\n        element7 = {\n      \"data\": features[i].slice(90, 105),\n      \"index\": features[i][104],\n      \"name\": \"element\"\n    },\n        element8 = {\n      \"data\": features[i].slice(105, 120),\n      \"index\": features[i][119],\n      \"name\": \"element\"\n    },\n        element9 = {\n      \"data\": features[i].slice(120, 135),\n      \"index\": features[i][134],\n      \"name\": \"element\"\n    },\n        element10 = {\n      \"data\": features[i].slice(135, 150),\n      \"index\": features[i][149],\n      \"name\": \"element\"\n    },\n        element11 = {\n      \"data\": features[i].slice(150, 165),\n      \"index\": features[i][164],\n      \"name\": \"element\"\n    },\n        element12 = {\n      \"data\": features[i].slice(165, 180),\n      \"index\": features[i][179],\n      \"name\": \"element\"\n    },\n        element13 = {\n      \"data\": features[i].slice(180, 195),\n      \"index\": features[i][194],\n      \"name\": \"element\"\n    },\n        element14 = {\n      \"data\": features[i].slice(195, 210),\n      \"index\": features[i][209],\n      \"name\": \"element\"\n    },\n        element15 = {\n      \"data\": features[i].slice(210, 225),\n      \"index\": features[i][224],\n      \"name\": \"element\"\n    },\n        element16 = {\n      \"data\": features[i].slice(225, 240),\n      \"index\": features[i][239],\n      \"name\": \"element\"\n    },\n        element17 = {\n      \"data\": features[i].slice(240, 255),\n      \"index\": features[i][254],\n      \"name\": \"element\"\n    },\n        element18 = {\n      \"data\": features[i].slice(255, 270),\n      \"index\": features[i][269],\n      \"name\": \"element\"\n    },\n        bg = {\n      \"data\": features[i].slice(288, 294),\n      \"name\": \"bg\"\n    };\n    var poster = [element, element2, element3, element4, element5, element6, element7, element8, element9, element10, element11, element12, element13, element14, element15, element16, element17, element18, bg];\n    createPoster(poster, i);\n    posterList.push(poster);\n  }\n}\n\nexport { _circleList, _rectList, _triList, _peopleList, height, width };\nexport { choosed, posterList, setChoosedNull };\nexport { createPoster, createCardPoster, createShapes, getDataCallback };","map":{"version":3,"sources":["/Users/yucheng/WebstormProjects/user-research-prototype/src/autobg/generator.js"],"names":["SVG","$","csv2array","data","delimeter","undefined","length","newline","eof","i","c","charAt","row","col","array","value","cnext","push","createRGBfromHSV","h","s","v","r","g","b","f","p","q","t","arguments","Math","floor","round","getNumberInNormalDistribution","std_dev","offset","randomNormalDistribution","u","w","random","sqrt","log","generateColor","colors","number","numberOfColor","colorList","n","hList","sList","vList","k","new_h","new_s","new_v","rgbList","hIndex","sIndex","vIndex","RGBs","posterIndex","backgroundPalette","elementPalettePure","elementPaletteGrad","skinPalette","colorRanNumber","colorRanRange","tRotation_1","tRotation_2","tRotation_3","tRotation_4","tRotation_5","tRotation_6","tRotation_7","sRotation_1","sRotation_2","cRotation","width","height","fontSizeSmall","fontSizeMid","fontSizeLarge","widthSegments","heightSegments","textIntersection","coreIntersections","normalIntersections","calIntersection","a1","b1","a2","b2","interPoint","heightGap","x","atan","j","y","loadxmlDoc","file","xmlDoc","window","ActiveXObject","e","document","implementation","createDocument","async","load","xmlhttp","XMLHttpRequest","open","send","responseXML","documentElement","ob","svg","getElementsByTagName","createShapes","cList","rList","tList","pList","draw","shape","group","getElementById","childNodes","transform","getAttribute","match","split","point","index","parseInt","id","elementTransform","parseFloat","indexOf","scaleValue","scale","cx","cy","attr","path","add","polygon","defs","ellipse","circle","transformHead","head","translate","addClass","headPaths","newPath","color","fill","rotateValue","rotate","headCircles","newCircle","arm","newArm","clothes","newClothes","pattern","newPattern","drawList","_circleList","_rectList","_triList","_peopleList","NUM_ELEMENT_TYPE","NUM_ELEMENT_X","NUM_ELEMENT_Y","randomRotation","shapeName","node","attributes","name","nodeValue","rotationAngel","choosed","createPoster","csvdata","num","subdiv","createElement","setAttribute","div","appendChild","body","size","circleList","concat","rectList","triList","shapeList","bgGradient","gradient","stop","bgHSV","at","from","to","rect","shapeNormalX","shapeNormalY","shapeNormalZ","elementColor","shapeNormal","clone","shapeScale","use","dx","dy","opacity","click","play","style","display","setChoosedNull","createCardPoster","peopleList","posterList","getDataCallback","features","console","element","slice","element2","element3","element4","element5","element6","element7","element8","element9","element10","element11","element12","element13","element14","element15","element16","element17","element18","bg","poster"],"mappings":"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","sourcesContent":["/*\n * @Author: 王志伟\n * @Date: 2019-07-19 16:39:16\n * @Last Modified by: 王志伟\n * @Last Modified time: 2019-07-26 14:17:34\n * @Content: 生成海报。其中只更改了createPoster函数，添加了createCardPoster函数，其他与原代码相同。\n */\nimport * as SVG from 'svg.js'\nimport $ from 'jquery'\n\n\nfunction csv2array(data, delimeter) {\n    // Retrieve the delimeter\n    if (delimeter === undefined)\n        delimeter = ',';\n    if (delimeter && delimeter.length > 1)\n        delimeter = ',';\n\n    // initialize variables\n    var newline = '\\n';\n    var eof = '';\n    var i = 0;\n    var c = data.charAt(i);\n    var row = 0;\n    var col = 0;\n    var array = [];\n\n    while (c !== eof) {\n        // skip whitespaces\n        while (c === ' ' || c === '\\t' || c === '\\r') {\n            c = data.charAt(++i); // read next char\n        }\n\n        // get value\n        var value = \"\";\n        if (c === '\"') {\n            // value enclosed by double-quotes\n            c = data.charAt(++i);\n\n            do {\n                if (c !== '\"') {\n                    // read a regular character and go to the next character\n                    value += c;\n                    c = data.charAt(++i);\n                }\n\n                if (c === '\"') {\n                    // check for escaped double-quote\n                    var cnext = data.charAt(i + 1);\n                    if (cnext === '\"') {\n                        // this is an escaped double-quote.\n                        // Add a double-quote to the value, and move two characters ahead.\n                        value += '\"';\n                        i += 2;\n                        c = data.charAt(i);\n                    }\n                }\n            }\n            while (c !== eof && c !== '\"');\n\n            if (c === eof) {\n                throw \"Unexpected end of data, double-quote expected\";\n            }\n\n            c = data.charAt(++i);\n        } else {\n            // value without quotes\n            while (c !== eof && c !== delimeter && c !== newline && c !== ' ' && c !== '\\t' && c !== '\\r') {\n                value += c;\n                c = data.charAt(++i);\n            }\n        }\n\n        // add the value to the array\n        if (array.length <= row)\n            array.push([]);\n        array[row].push(value);\n\n        // skip whitespaces\n        while (c === ' ' || c === '\\t' || c === '\\r') {\n            c = data.charAt(++i);\n        }\n\n        // go to the next row or column\n        if (c === delimeter) {\n            // to the next column\n            col = col + 1;\n        } else if (c === newline) {\n            // to the next row\n            col = 0;\n            row++;\n        } else if (c !== eof) {\n            // unexpected character\n            throw \"Delimiter expected after character \" + i;\n        }\n\n        // go to the next character\n        c = data.charAt(++i);\n    }\n\n    return array;\n}\n\nfunction createRGBfromHSV(h, s, v) {\n    var r, g, b, i, f, p, q, t;\n    if (arguments.length === 1) {\n        s = h.s;\n        v = h.v;\n        h = h.h;\n    }\n    i = Math.floor(h * 6);\n    f = h * 6 - i;\n    p = v * (1 - s);\n    q = v * (1 - f * s);\n    t = v * (1 - (1 - f) * s);\n    switch (i % 6) {\n        case 0:\n            r = v;\n            g = t;\n            b = p;\n            break;\n        case 1:\n            r = q;\n            g = v;\n            b = p;\n            break;\n        case 2:\n            r = p;\n            g = v;\n            b = t;\n            break;\n        case 3:\n            r = p;\n            g = q;\n            b = v;\n            break;\n        case 4:\n            r = t;\n            g = p;\n            b = v;\n            break;\n        case 5:\n            r = v;\n            g = p;\n            b = q;\n            break;\n        default:\n            break;\n    }\n    return {\n        r: Math.round(r * 255),\n        g: Math.round(g * 255),\n        b: Math.round(b * 255)\n    };\n}\n\n\nfunction getNumberInNormalDistribution(std_dev) {\n    var offset = randomNormalDistribution() * std_dev;\n    return offset;\n}\n\nfunction randomNormalDistribution() {\n    var u = 0.0,\n        v = 0.0,\n        w = 0.0,\n        c = 0.0;\n    do {\n        u = Math.random() * 2 - 1.0;\n        v = Math.random() * 2 - 1.0;\n        w = u * u + v * v;\n    } while (w === 0.0 || w >= 1.0)\n    c = Math.sqrt((-2 * Math.log(w)) / w);\n    return u * c;\n}\n\nfunction generateColor(colors, number, std_dev) {\n    var numberOfColor = colors.length;\n\n    var colorList = [];\n\n    for (var n = 0; n < colors.length; n++) {\n\n        var hList = [],\n            sList = [],\n            vList = [];\n\n        var k = number\n        for (k; k > 0; k--) {\n\n            var offset = getNumberInNormalDistribution(std_dev)\n\n            var new_h = colors[n][0] + offset;\n            var new_s = colors[n][1] + offset;\n            var new_v = colors[n][2] + offset;\n\n            if (new_h < 0) {\n                new_h = 360 + new_h\n            } else if (new_h > 360) {\n                new_h = new_h - 360\n            }\n\n            if (new_s < 0) {\n                new_s = new_s * -1\n            } else if (new_s > 100) {\n                new_s = 200 - new_s\n            }\n\n            if (new_v < 0) {\n                new_v = new_v * -1\n            } else if (new_v > 100) {\n                new_v = 200 - new_v\n            }\n\n            hList.push(new_h)\n            sList.push(new_s)\n            vList.push(new_v)\n        }\n\n        colorList.push([hList, sList, vList])\n\n    }\n\n    var rgbList = []\n    let hIndex, sIndex, vIndex;\n    for (hIndex in colorList[0][0]) {\n        for (sIndex in colorList[0][1]) {\n            for (vIndex in colorList[0][2]) {\n\n                var RGBs = [];\n                for (n = 0; n < numberOfColor; n++) {\n                    RGBs.push(createRGBfromHSV(colorList[n][0][hIndex] / 360, colorList[n][1][sIndex] / 100, colorList[n][2][vIndex] / 100))\n                }\n                rgbList.push(RGBs)\n            }\n        }\n    }\n\n    return rgbList\n}\n\nvar posterIndex = 0\n\nvar backgroundPalette = [],\n    elementPalettePure = [],\n    elementPaletteGrad = [];\n\n//face_color/nose,ear_color/neck_color\nvar skinPalette = [\n    [{\n        r: 252,\n        g: 234,\n        b: 202\n    }, {\n        r: 240,\n        g: 216,\n        b: 182\n    }, {\n        r: 230,\n        g: 203,\n        b: 159\n    }],\n    [{\n        r: 245,\n        g: 219,\n        b: 174\n    }, {\n        r: 232,\n        g: 202,\n        b: 160\n    }, {\n        r: 218,\n        g: 189,\n        b: 141\n    }],\n    [{\n        r: 228,\n        g: 196,\n        b: 142\n    }, {\n        r: 214,\n        g: 178,\n        b: 133\n    }, {\n        r: 204,\n        g: 166,\n        b: 113\n    }]\n]\n\nvar colorRanNumber = 10,\n    colorRanRange = 5;\nbackgroundPalette.push(generateColor([\n    [0, 0, 100]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [0, 0, 92]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [0, 0, 21]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [164, 15, 72]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [248, 36, 58]\n], colorRanNumber, colorRanRange))\n\nbackgroundPalette.push(generateColor([\n    [39, 49, 98],\n    [331, 60, 96]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [328, 33, 100],\n    [213, 26, 100]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [187, 43, 100],\n    [325, 21, 100]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [171, 49, 91],\n    [223, 44, 89]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [336, 42, 100],\n    [222, 93, 60]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [36, 32, 99],\n    [188, 52, 95]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [135, 64, 91],\n    [259, 67, 96]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [8, 25, 98],\n    [188, 51, 85]\n], colorRanNumber, colorRanRange))\n\ncolorRanRange = 8\nelementPalettePure.push(generateColor([\n    [0, 0, 100]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [0, 0, 84]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [77, 13, 21]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [252, 59, 100]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [154, 37, 94]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [339, 40, 100]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [47, 78, 98]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [296, 59, 99]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [187, 45, 91]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [347, 78, 100]\n], colorRanNumber, colorRanRange))\n\nelementPaletteGrad.push(generateColor([\n    [0, 0, 93],\n    [0, 0, 47]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [51, 19, 100],\n    [334, 45, 100]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [58, 83, 100],\n    [326, 80, 95]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [24, 49, 100],\n    [274, 79, 91]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [135, 64, 91],\n    [62, 81, 96]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [135, 64, 91],\n    [259, 67, 96]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [352, 42, 99],\n    [183, 75, 95]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [319, 86, 89],\n    [190, 46, 93]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [181, 80, 93],\n    [259, 67, 96]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [207, 86, 89],\n    [273, 82, 57]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [30, 11, 93],\n    [23, 44, 74]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [187, 43, 100],\n    [325, 21, 100]\n], colorRanNumber, colorRanRange))\n\n//Rotation\n\nvar tRotation_1 = [0, 30, 60, 90, 120, 150, 180],\n    tRotation_2 = [0, 36, 72, 108, 144, 180],\n    tRotation_3 = [0, 30, 60, 90, 120, 150, 180],\n    tRotation_4 = [0, 180],\n    tRotation_5 = [0, 45, 90, 135, 180],\n    tRotation_6 = [0, 60, 90, 150, 180],\n    tRotation_7 = [0, 30, 60, 90, 120, 150, 180],\n\n    sRotation_1 = [0, 30, 60, 90, 120, 150, 180],\n    sRotation_2 = [0, 45, 90, 135, 180],\n\n    cRotation = [0, 45, 90, 135, 180];\n\n\n//Layout\n\nvar width = 1080 / 4,\n    height = 1314 / 4;\nvar fontSizeSmall = 5,\n    fontSizeMid = 8,\n    fontSizeLarge = 10;\n\n//resize\nwidth /= 2;\nheight /= 2;\nfontSizeSmall /= 2;\nfontSizeMid /= 2;\nfontSizeLarge /= 2;\n\n\nvar widthSegments = 15,\n    heightSegments = 20;\n\n//position for laying texts\nvar textIntersection = [];\ntextIntersection[0] = [(width / widthSegments) * 2, (height / heightSegments) * 2, 0]\ntextIntersection[1] = [(width / widthSegments) * 17, (height / heightSegments) * 2, 0]\ntextIntersection[2] = [(width / widthSegments) * 2, (height / heightSegments) * 32, 0]\ntextIntersection[3] = [(width / widthSegments) * 17, (height / heightSegments) * 32, 0]\n\nvar coreIntersections = [],\n    normalIntersections = [];\n\n//center\ncoreIntersections[0] = [width / 2, height / 2, 0];\n//three-folds\ncoreIntersections[1] = [width / 3, height / 3, 0];\ncoreIntersections[2] = [width / 3, height * 2 / 3, 0];\ncoreIntersections[3] = [width * 2 / 3, height / 3, 0];\ncoreIntersections[4] = [width * 2 / 3, height * 2 / 3, 0];\n//squre-intersection\ncoreIntersections[5] = calIntersection(height / width, 0, -width / height, width * width / height);\n//coreIntersections[5].push(Math.atan(-width/height)*90)\ncoreIntersections[5].push(0)\n\ncoreIntersections[6] = calIntersection(height / width, 0, -width / height, height)\n//coreIntersections[6].push(Math.atan(-width/height)*90)\ncoreIntersections[6].push(0)\n\ncoreIntersections[7] = calIntersection(-height / width, height, width / height, height - (width * width / height))\n//coreIntersections[7].push(Math.atan(width/height)*90)\ncoreIntersections[7].push(0)\n\ncoreIntersections[8] = calIntersection(-height / width, height, width / height, 0)\n//coreIntersections[8].push(Math.atan(width/height)*90)\ncoreIntersections[8].push(0)\n\nfunction calIntersection(a1, b1, a2, b2) {\n    var interPoint = []\n    //x\n    interPoint[0] = (b2 - b1) / (a1 - a2)\n    //y\n    interPoint[1] = a1 * interPoint[0] + b1\n    return interPoint\n}\n\n\n// Draw white points\n// var widthGap = width/widthSegments;\nvar heightGap = height / heightSegments;\n// var lineStyle_2 = {width: 0.5 ,color: '#C1BAC6'}\n\nfor (var i = 1; i < widthSegments; i++) {\n\n    var x = heightGap * i\n    //draw.line(x,0,x,height).stroke(lineStyle_2)\n\n    //calculate interaction with horizontal lines\n    normalIntersections.push([x, x * height / width, Math.atan(height / width) * 90])\n    normalIntersections.push([x, x * (-height / width) + height, Math.atan(-height / width) * 90])\n    normalIntersections.push([x, x * (-width / height) + width * width / height, Math.atan(-width / height) * 90])\n    normalIntersections.push([x, x * (-width / height) + height, Math.atan(-width / height) * 90])\n    normalIntersections.push([x, x * width / height + height - (width * width / height), Math.atan(width / height) * 90])\n    normalIntersections.push([x, x * width / height, Math.atan(width / height) * 90])\n}\nfor (var j = 1; j < heightSegments; j++) {\n    var y = heightGap * j\n    //draw.line(0,y,width,y).stroke(lineStyle_2)\n\n    normalIntersections.push([y / (height / width), y, Math.atan(height / width) * 90])\n    normalIntersections.push([(y - height) / (-height / width), y, Math.atan(-height / width) * 90])\n\n\n    if (y <= width * width / height) {\n        normalIntersections.push([(y - width * width / height) / (-width / height), y, Math.atan(-width / height) * 90])\n        normalIntersections.push([y / (width / height), y, Math.atan(width / height) * 90])\n    }\n\n    if (y >= height - width * width / height && y < height) {\n        normalIntersections.push([(y - height) / (-width / height), y, Math.atan(-width / height) * 90])\n        normalIntersections.push([(y - height + (width * width / height)) / (width / height), y, Math.atan(width / height) * 90])\n    }\n}\n\n// ==================================================================\n\nfunction loadxmlDoc(file) {\n    let xmlDoc;\n    try {\n        //IE\n        xmlDoc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n    } catch (e) {\n        ////Firefox, Mozilla, Opera, etc\n        xmlDoc = document.implementation.createDocument(\"\", \"\", null);\n    }\n\n    try {\n        xmlDoc.async = false;\n        xmlDoc.load(file);\n    } catch (e) {\n        // for Chrome\n        var xmlhttp = new window.XMLHttpRequest();\n        // console.log(xmlhttp);\n        xmlhttp.open(\"GET\", file, false);\n        xmlhttp.send(null);\n        xmlDoc = xmlhttp.responseXML.documentElement;\n        // Sconsole.log(xmlDoc);\n    }\n    return xmlDoc;\n}\n\nvar ob = loadxmlDoc(\"/all.xml\");\nvar svg = ob.getElementsByTagName(\"svg\");\n\n\n//create all possible shapes in the canvas\nfunction createShapes(cList, rList, tList, pList, draw) {\n    for (var i = 0; i < svg.length; i++) {\n        var shape = draw.group()\n        let data;\n        if (svg[i].getElementById('triangle')) {\n            data = svg[i].getElementById('triangle').childNodes[1]\n            var transform = svg[i].getElementById('triangle').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n            var point = svg[i].getElementById('point')\n            var index = (parseInt(data.id.split(\"/\")[1]) + 4) + (parseInt(data.id.split(\"/\")[2]) + 4) * 9\n\n            // console.log(data.id)\n\n            //check if the element has transform data\n            if (svg[i].getElementById(data.id).getAttribute(\"transform\")) {\n                var elementTransform = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n                // console.log(elementTransform)\n                transform[0] = parseFloat(transform[0]) + parseFloat(elementTransform[0])\n                transform[1] = parseFloat(transform[1]) + parseFloat(elementTransform[1])\n\n                if (svg[i].getElementById(data.id).getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n                    var scaleValue = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',')\n                    shape.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]))\n                }\n            }\n\n            // set attributes of shape\n            if (point) {\n                var cx = parseFloat(point.getAttribute(\"x\"))\n                var cy = parseFloat(point.getAttribute(\"y\"))\n                shape.attr({\n                    \"name\": data.id,\n                    \"cx\": cx,\n                    \"cy\": cy,\n                    \"transform\": \"translate(\" + (parseFloat(transform[0]) - cx) + \",\" + (parseFloat(transform[1]) - cy) + \")\",\n                    \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                    \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n                })\n            } else {\n                shape.attr({\n                    \"name\": data.id,\n                    \"transform\": \"translate(\" + (parseFloat(transform[0]) - parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) - parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n                    \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                    \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n                })\n            }\n\n            // set content of shape\n            if (svg[i].getElementsByTagName('path')[0]) {\n                shape.path(svg[i].getElementsByTagName('path')[0].getAttribute(\"d\"))\n            } else if (svg[i].getElementsByTagName('polygon')[0]) {\n                shape.add(draw.polygon().attr(\"points\", svg[i].getElementsByTagName('polygon')[0].getAttribute(\"points\")))\n            }\n\n            draw.defs().add(shape)\n            tList[index] = shape\n\n\n        } else if (svg[i].getElementById('square')) {\n            data = svg[i].getElementById('square').childNodes[1]\n            var transform = svg[i].getElementById('square').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n            var point = svg[i].getElementById('point')\n            var index = (parseInt(data.id.split(\"/\")[1]) + 4) + (parseInt(data.id.split(\"/\")[2]) + 4) * 9\n\n\n            //check if the element has transform data\n            if (svg[i].getElementById(data.id).getAttribute(\"transform\")) {\n                var elementTransform = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n                // console.log(elementTransform)\n                transform[0] = parseFloat(transform[0]) + parseFloat(elementTransform[0])\n                transform[1] = parseFloat(transform[1]) + parseFloat(elementTransform[1])\n\n                if (svg[i].getElementById(data.id).getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n                    var scaleValue = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',')\n                    shape.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]))\n                }\n            }\n\n            // set attributes of shape\n            if (point) {\n                var cx = parseFloat(point.getAttribute(\"x\"))\n                var cy = parseFloat(point.getAttribute(\"y\"))\n                shape.attr({\n                    \"name\": data.id,\n                    \"cx\": cx,\n                    \"cy\": cy,\n                    \"transform\": \"translate(\" + (parseFloat(transform[0]) - cx) + \",\" + (parseFloat(transform[1]) - cy) + \")\",\n                    \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                    \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n                })\n            } else {\n                shape.attr({\n                    \"name\": data.id,\n                    \"transform\": \"translate(\" + (parseFloat(transform[0]) - parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) - parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n                    \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                    \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n                })\n            }\n\n            // set content of shape\n            if (svg[i].getElementsByTagName('path')[0]) {\n                shape.path(svg[i].getElementsByTagName('path')[0].getAttribute(\"d\"))\n            } else if (svg[i].getElementsByTagName('polygon')[0]) {\n                shape.add(draw.polygon().attr(\"points\", svg[i].getElementsByTagName('polygon')[0].getAttribute(\"points\")))\n            }\n\n            draw.defs().add(shape)\n            rList[index] = shape\n\n\n        } else if (svg[i].getElementById('circular')) {\n            data = svg[i].getElementById('circular').childNodes[1]\n            var transform = svg[i].getElementById('circular').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n            var point = svg[i].getElementById('point')\n            var index = (parseInt(data.id.split(\"/\")[1]) + 4) + (parseInt(data.id.split(\"/\")[2]) + 4) * 9\n\n            //check if the element has transform data\n            if (svg[i].getElementById(data.id).getAttribute(\"transform\")) {\n                var elementTransform = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n                // console.log(elementTransform)\n                transform[0] = parseFloat(transform[0]) + parseFloat(elementTransform[0])\n                transform[1] = parseFloat(transform[1]) + parseFloat(elementTransform[1])\n\n                if (svg[i].getElementById(data.id).getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n                    var scaleValue = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',')\n                    shape.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]))\n                }\n            }\n\n            // set attributes of shape\n            if (point) {\n                var cx = parseFloat(point.getAttribute(\"x\"))\n                var cy = parseFloat(point.getAttribute(\"y\"))\n                shape.attr({\n                    \"name\": data.id,\n                    \"cx\": cx,\n                    \"cy\": cy,\n                    \"transform\": \"translate(\" + (parseFloat(transform[0]) - cx) + \",\" + (parseFloat(transform[1]) - cy) + \")\",\n                    \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                    \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n                })\n            } else {\n                shape.attr({\n                    \"name\": data.id,\n                    \"transform\": \"translate(\" + (parseFloat(transform[0]) - parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) - parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n                    \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                    \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n                })\n            }\n\n            // set content of shape\n            if (svg[i].getElementsByTagName('path')[0]) {\n                shape.path(svg[i].getElementsByTagName('path')[0].getAttribute(\"d\"))\n            } else if (svg[i].getElementsByTagName('ellipse')[0]) {\n                shape.add(draw.ellipse().attr({\n                    \"cx\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"cx\"),\n                    \"cy\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"cy\"),\n                    \"rx\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"rx\"),\n                    \"ry\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"ry\")\n                }))\n            } else if (svg[i].getElementsByTagName('circle')[0]) {\n                shape.add(draw.circle().attr({\n                    \"cx\": svg[i].getElementsByTagName('circle')[0].getAttribute(\"cx\"),\n                    \"cy\": svg[i].getElementsByTagName('circle')[0].getAttribute(\"cy\"),\n                    \"r\": svg[i].getElementsByTagName('circle')[0].getAttribute(\"r\")\n                }))\n            }\n\n            draw.defs().add(shape)\n            cList[index] = shape\n\n        } else if (svg[i].getElementById('people')) {\n            data = svg[i].getElementById('people').childNodes[1]\n            var transform = svg[i].getElementById('people').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n            shape.attr({\n                \"name\": data.id,\n                \"transform\": \"translate(\" + (parseFloat(transform[0]) + parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) + parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n                \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n            })\n\n            var transformHead = svg[i].getElementById('head').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n            var head = draw.group().translate(parseFloat(transformHead[0]), parseFloat(transformHead[1])).addClass(\"head\")\n\n            var headPaths = svg[i].getElementById('head').getElementsByTagName(\"path\")\n\n            // console.log(headPaths)\n            for (var index = 0; index < headPaths.length; index++) {\n                var newPath = draw.path(headPaths[index].getAttribute(\"d\"))\n                if (headPaths[index].getAttribute(\"id\") === \"nose\" || headPaths[index].getAttribute(\"id\") === \"ear\" || headPaths[index].getAttribute(\"id\") === \"ear2\")\n                    newPath.addClass(\"nose\")\n                if (headPaths[index].getAttribute(\"id\") === \"shadow\")\n                    newPath.addClass(\"shadow\")\n                if (headPaths[index].getAttribute(\"id\") === \"face\" || headPaths[index].getAttribute(\"id\") === \"neck\")\n                    newPath.addClass(\"skin\")\n\n                if (headPaths[index].getAttribute(\"fill\")) {\n                    var color = headPaths[index].getAttribute(\"fill\")\n                    newPath.fill(color)\n                }\n\n                if (headPaths[index].getAttribute(\"transform\")) {\n\n                    if (headPaths[index].getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n                        var scaleValue = headPaths[index].getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',')\n                        newPath.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]))\n                    }\n\n                    if (headPaths[index].getAttribute(\"transform\").indexOf(\"rotate\") > 0) {\n                        var rotateValue = headPaths[index].getAttribute(\"transform\").match(/rotate.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0]\n                        newPath.rotate(parseFloat(rotateValue))\n                    }\n\n                }\n\n                head.add(newPath)\n            }\n\n            var headCircles = svg[i].getElementById('head').getElementsByTagName(\"ellipse\")\n            for (var index = 0; index < headCircles.length; index++) {\n                var newCircle = draw.ellipse().attr({\n                    \"cx\": headCircles[index].getAttribute(\"cx\"),\n                    \"cy\": headCircles[index].getAttribute(\"cy\"),\n                    \"rx\": headCircles[index].getAttribute(\"rx\"),\n                    \"ry\": headCircles[index].getAttribute(\"ry\")\n                })\n\n                if (headCircles[index].getAttribute(\"fill\")) {\n                    var color = headCircles[index].getAttribute(\"fill\")\n                    newCircle.fill(color)\n                }\n\n                if (headCircles[index].getAttribute(\"transform\")) {\n\n                    if (headCircles[index].getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n                        var scaleValue = headCircles[index].getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',')\n                        newCircle.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]))\n                    }\n                    if (headCircles[index].getAttribute(\"transform\").indexOf(\"rotate\") > 0) {\n                        var rotateValue = headCircles[index].getAttribute(\"transform\").match(/rotate.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0]\n                        newCircle.rotate(parseFloat(rotateValue))\n                    }\n\n                }\n\n                head.add(newCircle)\n            }\n\n\n            var arm = svg[i].getElementById('arm')\n            var newArm = draw.path(arm.getAttribute(\"d\")).fill(arm.getAttribute(\"fill\")).addClass(\"skin\")\n\n\n            var clothes = svg[i].getElementById('clothes')\n            var newClothes = draw.path(clothes.getAttribute(\"d\")).addClass(\"clothes\")\n\n\n            var pattern = svg[i].getElementById('pattern').getElementsByTagName(\"path\")[0]\n            var newPattern = draw.path(pattern.getAttribute(\"d\")).addClass('logo')\n\n            var transform = svg[i].getElementById('pattern').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n            var color = svg[i].getElementById('pattern').getAttribute(\"fill\")\n\n            newPattern.attr({\n                \"transform\": \"translate(\" + parseFloat(transform[0]) + \",\" + parseFloat(transform[1]) + \")\"\n            })\n            newPattern.fill(color)\n\n            shape.add(head)\n            shape.add(newArm)\n            shape.add(newClothes)\n            shape.add(newPattern)\n\n            draw.defs().add(shape)\n            pList.push(shape)\n\n        }\n    }\n\n}\n\nvar drawList = []\n\n\n// var _draw = SVG('postContainer').size(width, height)\n// var _circleList = [], _rectList = [], _triList = [], _peopleList = []\n// createShapes(_circleList,_rectList,_triList,_peopleList,_draw)\n\nvar _circleList = [],\n    _rectList = [],\n    _triList = [],\n    _peopleList = []\n\n//Define the number of deatures for each shape\n// const NUM_SHAPE_FEATURES=15,\n// \t  MAX_ELEMENTS = 18,\n// \t  NUM_PEOPLE_FEATURES = 17,\n// \t  NUM_TEXT_FEATURES =1,\n// \t  NUM_BG_FEATURES = 6;\nconst NUM_ELEMENT_TYPE = 3,\n    NUM_ELEMENT_X = 9,\n    NUM_ELEMENT_Y = 9;\n\n\nfunction rotate(shape, index) {\n    var randomRotation = index\n    var shapeName = shape.node.attributes.name.nodeValue.split(\"/\")\n    var rotationAngel\n\n    if (shapeName[0] === \"t\") {\n        if (parseInt(shapeName[1]) === -4) {\n            rotationAngel = tRotation_1[parseInt(tRotation_1.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) === -3) {\n            rotationAngel = tRotation_2[parseInt(tRotation_2.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) === -2 || parseInt(shapeName[1]) === -1 || parseInt(shapeName[1]) === 0) {\n            rotationAngel = tRotation_3[parseInt(tRotation_3.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) === 1) {\n            rotationAngel = tRotation_4[parseInt(tRotation_4.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) === 2) {\n            rotationAngel = tRotation_5[parseInt(tRotation_5.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) === 3) {\n            rotationAngel = tRotation_6[parseInt(tRotation_6.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) === 4) {\n            rotationAngel = tRotation_7[parseInt(tRotation_7.length * randomRotation)]\n        }\n\n    }\n    //\n    else if (shapeName[0] === \"s\") {\n        if (parseInt(shapeName[1]) >= -4 && parseInt(shapeName[1]) <= -1) {\n            rotationAngel = sRotation_1[parseInt(sRotation_1.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) >= 0 && parseInt(shapeName[1]) <= 4) {\n            rotationAngel = sRotation_2[parseInt(sRotation_2.length * randomRotation)]\n        }\n    } else if (shapeName[0] === \"c\") {\n        rotationAngel = cRotation[parseInt(cRotation.length * randomRotation)]\n    }\n\n    if (shape.attr(\"cx\") && shape.attr(\"cy\")) {\n        shape\n            .rotate(rotationAngel, shape.attr(\"cx\"), shape.attr(\"cy\"))\n    } else {\n        shape\n            .rotate(rotationAngel)\n    }\n\n    return randomRotation;\n}\n\n// var div = document.createElement(\"div\");\n// div.setAttribute(\"id\", \"container\");\n\n// 被选中的海报\nvar choosed = null;\n\n// 生成海报，并为每一张海报添加click函数\nfunction createPoster(csvdata, num) {\n\n    var subdiv = document.createElement(\"div\");\n    subdiv.setAttribute(\"id\", \"poster\"+num);\n    subdiv.setAttribute(\"class\", \"poster\");\n    div.appendChild(subdiv)\n    document.body.appendChild(div);\n    // console.log(pnt.state);\n    var draw = SVG('poster'+num).size(width, height)\n\n\n    var circleList = _circleList.concat(),\n        rectList = _rectList.concat(),\n        triList = _triList.concat();\n\n    var shapeList = triList.concat(rectList, circleList);\n\n    var bgGradient = draw.gradient('linear', function (stop) {\n        var bgHSV = csvdata[csvdata.length - 1]\n        stop.at(0, createRGBfromHSV(bgHSV.data[0], bgHSV.data[1], bgHSV.data[2]))\n        stop.at(1, createRGBfromHSV(bgHSV.data[3], bgHSV.data[4], bgHSV.data[5]))\n    })\n    bgGradient.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n    draw.rect(width, height).fill(bgGradient)\n    // let start = new Date().getTime();\n    for (var i = 0; i < csvdata.length; i++) {\n        if (csvdata[i].name === \"element\") {\n            var shapeNormalX = Math.round((NUM_ELEMENT_TYPE - 1) * csvdata[i].data[0]),\n                shapeNormalY = Math.round((NUM_ELEMENT_X - 1) * csvdata[i].data[1]),\n                shapeNormalZ = Math.round((NUM_ELEMENT_Y - 1) * csvdata[i].data[2]);\n\n            var elementColor = draw.gradient('linear', function (stop) {\n                stop.at(0, createRGBfromHSV(csvdata[i].data[7], csvdata[i].data[8], csvdata[i].data[9]))\n                stop.at(1, createRGBfromHSV(csvdata[i].data[10], csvdata[i].data[11], csvdata[i].data[12]))\n            })\n            elementColor.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n\n            // console.log(shapeList)\n            //console.log(shapeNormalX,shapeNormalY,shapeNormalZ,shapeNormalX*NUM_ELEMENT_X*NUM_ELEMENT_Y+NUM_ELEMENT_X*shapeNormalY+shapeNormalZ)\n\n            var shapeNormal = shapeList[shapeNormalX * NUM_ELEMENT_X * NUM_ELEMENT_Y + NUM_ELEMENT_X * shapeNormalY + shapeNormalZ].clone()\n\n            var shapeScale = Math.sqrt((width * height) * csvdata[i].data[3] / (shapeNormal.width() * shapeNormal.height()))\n\n            draw.use(shapeNormal)\n\n            // console.log(width*csvdata[i].data[4],height*csvdata[i].data[5],shapeScale,parseFloat(csvdata[i].data[13]))\n\n            shapeNormal\n                .dx(width * csvdata[i].data[4])\n                .dy(height * csvdata[i].data[5])\n\n            rotate(shapeNormal, csvdata[i].data[6])\n\n            shapeNormal\n                .scale(shapeScale, shapeScale)\n                .fill(elementColor)\n                .opacity(parseFloat(csvdata[i].data[13]))\n        }\n    }\n    // console.log('for:')\n    // console.log(new Date().getTime()-start);\n    drawList.push(draw);\n    draw.attr('num', num);\n    draw.click(function () {\n        document.getElementById(\"audio-click\").play();\n\n        // 点击海报则放大显示\n        document.getElementById('chooseposter').style.display = 'block';\n        document.getElementById('overlay0').style.display = 'block';\n        if (choosed === null)\n            choosed = SVG(\"choosed\").fill('#0f4');\n        choosed.svg(draw.svg());\n        choosed.attr({\n            'num': num\n        });\n        choosed.scale(4.92);\n        choosed.translate(1294, 1559);\n        // pnt.setState({\n        //     num: draw.attr('num')\n        // });\n\n        // 添加放大动画\n        $(\"#chooseposter\").addClass(\"choose-poster-ani\");\n    })\n}\n\n\nfunction setChoosedNull() {\n    choosed = null;\n}\n\n// 生成“输入名字”页面的卡片上的海报\nfunction createCardPoster(csvdata) {\n    width *= 4.92;\n    height *= 4.92;\n    fontSizeSmall *= 4.92;\n    fontSizeMid *= 4.92;\n    fontSizeLarge *= 4.92;\n    var draw = SVG('cardPoster').size(width, height);\n\n    // var circleList = _circleList.concat(), rectList = _rectList.concat(), triList = _triList.concat(), peopleList = _peopleList.concat()\n    var circleList = [],\n        rectList = [],\n        triList = [],\n        peopleList = [];\n\n    createShapes(circleList, rectList, triList, peopleList, draw)\n\n    var shapeList = triList.concat(rectList, circleList)\n\n    var bgGradient = draw.gradient('linear', function (stop) {\n        var bgHSV = csvdata[csvdata.length - 1]\n        stop.at(0, createRGBfromHSV(bgHSV.data[0], bgHSV.data[1], bgHSV.data[2]))\n        stop.at(1, createRGBfromHSV(bgHSV.data[3], bgHSV.data[4], bgHSV.data[5]))\n    })\n    bgGradient.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n    draw.rect(width, height).fill(bgGradient)\n    // let start = new Date().getTime();\n    for (var i = 0; i < csvdata.length; i++) {\n        if (csvdata[i].name === \"element\") {\n            var shapeNormalX = Math.round((NUM_ELEMENT_TYPE - 1) * csvdata[i].data[0]),\n                shapeNormalY = Math.round((NUM_ELEMENT_X - 1) * csvdata[i].data[1]),\n                shapeNormalZ = Math.round((NUM_ELEMENT_Y - 1) * csvdata[i].data[2]);\n\n            var elementColor = draw.gradient('linear', function (stop) {\n                stop.at(0, createRGBfromHSV(csvdata[i].data[7], csvdata[i].data[8], csvdata[i].data[9]))\n                stop.at(1, createRGBfromHSV(csvdata[i].data[10], csvdata[i].data[11], csvdata[i].data[12]))\n            })\n            elementColor.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n\n            // console.log(shapeList)\n            //console.log(shapeNormalX,shapeNormalY,shapeNormalZ,shapeNormalX*NUM_ELEMENT_X*NUM_ELEMENT_Y+NUM_ELEMENT_X*shapeNormalY+shapeNormalZ)\n\n            var shapeNormal = shapeList[shapeNormalX * NUM_ELEMENT_X * NUM_ELEMENT_Y + NUM_ELEMENT_X * shapeNormalY + shapeNormalZ].clone()\n\n            var shapeScale = Math.sqrt((width * height) * csvdata[i].data[3] / (shapeNormal.width() * shapeNormal.height()))\n\n            draw.use(shapeNormal)\n\n            // console.log(width*csvdata[i].data[4],height*csvdata[i].data[5],shapeScale,parseFloat(csvdata[i].data[13]))\n\n            shapeNormal\n                .dx(width * csvdata[i].data[4])\n                .dy(height * csvdata[i].data[5])\n\n            rotate(shapeNormal, csvdata[i].data[6])\n\n            shapeNormal\n                .scale(shapeScale, shapeScale)\n                .fill(elementColor)\n                .opacity(parseFloat(csvdata[i].data[13]))\n        }\n    }\n\n}\n\nvar posterList = [];\nvar div;\n// 获取到服务器返回的csv文件后的回调函数\nfunction getDataCallback(data) {\n    // $.get(\"/test.csv\",function(data){\n    // console.log(data);\n    var features = csv2array(data);\n\n    console.log(features)\n\n    for (var i = 0; i < features.length; i++) {\n        var element = {\n                \"data\": features[i].slice(0, 15),\n                \"index\": features[i][14],\n                \"name\": \"element\"\n            },\n            element2 = {\n                \"data\": features[i].slice(15, 30),\n                \"index\": features[i][29],\n                \"name\": \"element\"\n            },\n            element3 = {\n                \"data\": features[i].slice(30, 45),\n                \"index\": features[i][44],\n                \"name\": \"element\"\n            },\n            element4 = {\n                \"data\": features[i].slice(45, 60),\n                \"index\": features[i][59],\n                \"name\": \"element\"\n            },\n            element5 = {\n                \"data\": features[i].slice(60, 75),\n                \"index\": features[i][74],\n                \"name\": \"element\"\n            },\n            element6 = {\n                \"data\": features[i].slice(75, 90),\n                \"index\": features[i][89],\n                \"name\": \"element\"\n            },\n            element7 = {\n                \"data\": features[i].slice(90, 105),\n                \"index\": features[i][104],\n                \"name\": \"element\"\n            },\n            element8 = {\n                \"data\": features[i].slice(105, 120),\n                \"index\": features[i][119],\n                \"name\": \"element\"\n            },\n            element9 = {\n                \"data\": features[i].slice(120, 135),\n                \"index\": features[i][134],\n                \"name\": \"element\"\n            },\n            element10 = {\n                \"data\": features[i].slice(135, 150),\n                \"index\": features[i][149],\n                \"name\": \"element\"\n            },\n            element11 = {\n                \"data\": features[i].slice(150, 165),\n                \"index\": features[i][164],\n                \"name\": \"element\"\n            },\n            element12 = {\n                \"data\": features[i].slice(165, 180),\n                \"index\": features[i][179],\n                \"name\": \"element\"\n            },\n            element13 = {\n                \"data\": features[i].slice(180, 195),\n                \"index\": features[i][194],\n                \"name\": \"element\"\n            },\n            element14 = {\n                \"data\": features[i].slice(195, 210),\n                \"index\": features[i][209],\n                \"name\": \"element\"\n            },\n            element15 = {\n                \"data\": features[i].slice(210, 225),\n                \"index\": features[i][224],\n                \"name\": \"element\"\n            },\n            element16 = {\n                \"data\": features[i].slice(225, 240),\n                \"index\": features[i][239],\n                \"name\": \"element\"\n            },\n            element17 = {\n                \"data\": features[i].slice(240, 255),\n                \"index\": features[i][254],\n                \"name\": \"element\"\n            },\n            element18 = {\n                \"data\": features[i].slice(255, 270),\n                \"index\": features[i][269],\n                \"name\": \"element\"\n            },\n            bg = {\n                \"data\": features[i].slice(288, 294),\n                \"name\": \"bg\"\n            };\n\n        var poster = [element, element2, element3, element4, element5, element6, element7, element8, element9, element10, element11,\n            element12, element13, element14, element15, element16, element17, element18, bg]\n\n        createPoster(poster, i)\n\n        posterList.push(poster);\n    }\n}\n\nexport {\n    _circleList,\n    _rectList,\n    _triList,\n    _peopleList,\n    height,\n    width\n};\n\nexport {\n    choosed,\n    posterList,\n    setChoosedNull\n};\n\nexport {\n    createPoster,\n    createCardPoster,\n    createShapes,\n    getDataCallback\n};"]},"metadata":{},"sourceType":"module"}