{"ast":null,"code":"/*\n * @Author: 王志伟\n * @Date: 2019-07-19 16:39:16\n * @Last Modified by: 王志伟\n * @Last Modified time: 2019-07-26 14:17:34\n * @Content: 生成海报。其中只更改了createPoster函数，添加了createCardPoster函数，其他与原代码相同。\n */\nimport * as SVG from 'svg.js';\nimport $ from 'jquery';\n\nfunction csv2array(data, delimeter) {\n  // Retrieve the delimeter\n  if (delimeter === undefined) delimeter = ',';\n  if (delimeter && delimeter.length > 1) delimeter = ','; // initialize variables\n\n  var newline = '\\n';\n  var eof = '';\n  var i = 0;\n  var c = data.charAt(i);\n  var row = 0;\n  var col = 0;\n  var array = [];\n\n  while (c !== eof) {\n    // skip whitespaces\n    while (c === ' ' || c === '\\t' || c === '\\r') {\n      c = data.charAt(++i); // read next char\n    } // get value\n\n\n    var value = \"\";\n\n    if (c === '\"') {\n      // value enclosed by double-quotes\n      c = data.charAt(++i);\n\n      do {\n        if (c !== '\"') {\n          // read a regular character and go to the next character\n          value += c;\n          c = data.charAt(++i);\n        }\n\n        if (c === '\"') {\n          // check for escaped double-quote\n          var cnext = data.charAt(i + 1);\n\n          if (cnext === '\"') {\n            // this is an escaped double-quote.\n            // Add a double-quote to the value, and move two characters ahead.\n            value += '\"';\n            i += 2;\n            c = data.charAt(i);\n          }\n        }\n      } while (c !== eof && c !== '\"');\n\n      if (c === eof) {\n        throw \"Unexpected end of data, double-quote expected\";\n      }\n\n      c = data.charAt(++i);\n    } else {\n      // value without quotes\n      while (c !== eof && c !== delimeter && c !== newline && c !== ' ' && c !== '\\t' && c !== '\\r') {\n        value += c;\n        c = data.charAt(++i);\n      }\n    } // add the value to the array\n\n\n    if (array.length <= row) array.push([]);\n    array[row].push(value); // skip whitespaces\n\n    while (c === ' ' || c === '\\t' || c === '\\r') {\n      c = data.charAt(++i);\n    } // go to the next row or column\n\n\n    if (c === delimeter) {\n      // to the next column\n      col = col + 1;\n    } else if (c === newline) {\n      // to the next row\n      col = 0;\n      row++;\n    } else if (c !== eof) {\n      // unexpected character\n      throw \"Delimiter expected after character \" + i;\n    } // go to the next character\n\n\n    c = data.charAt(++i);\n  }\n\n  return array;\n}\n\nfunction createRGBfromHSV(h, s, v) {\n  var r, g, b, i, f, p, q, t;\n\n  if (arguments.length === 1) {\n    s = h.s;\n    v = h.v;\n    h = h.h;\n  }\n\n  i = Math.floor(h * 6);\n  f = h * 6 - i;\n  p = v * (1 - s);\n  q = v * (1 - f * s);\n  t = v * (1 - (1 - f) * s);\n\n  switch (i % 6) {\n    case 0:\n      r = v;\n      g = t;\n      b = p;\n      break;\n\n    case 1:\n      r = q;\n      g = v;\n      b = p;\n      break;\n\n    case 2:\n      r = p;\n      g = v;\n      b = t;\n      break;\n\n    case 3:\n      r = p;\n      g = q;\n      b = v;\n      break;\n\n    case 4:\n      r = t;\n      g = p;\n      b = v;\n      break;\n\n    case 5:\n      r = v;\n      g = p;\n      b = q;\n      break;\n\n    default:\n      break;\n  }\n\n  return {\n    r: Math.round(r * 255),\n    g: Math.round(g * 255),\n    b: Math.round(b * 255)\n  };\n}\n\nfunction getNumberInNormalDistribution(std_dev) {\n  var offset = randomNormalDistribution() * std_dev;\n  return offset;\n}\n\nfunction randomNormalDistribution() {\n  var u = 0.0,\n      v = 0.0,\n      w = 0.0,\n      c = 0.0;\n\n  do {\n    u = Math.random() * 2 - 1.0;\n    v = Math.random() * 2 - 1.0;\n    w = u * u + v * v;\n  } while (w === 0.0 || w >= 1.0);\n\n  c = Math.sqrt(-2 * Math.log(w) / w);\n  return u * c;\n}\n\nfunction generateColor(colors, number, std_dev) {\n  var numberOfColor = colors.length;\n  var colorList = [];\n\n  for (var n = 0; n < colors.length; n++) {\n    var hList = [],\n        sList = [],\n        vList = [];\n    var k = number;\n\n    for (k; k > 0; k--) {\n      var offset = getNumberInNormalDistribution(std_dev);\n      var new_h = colors[n][0] + offset;\n      var new_s = colors[n][1] + offset;\n      var new_v = colors[n][2] + offset;\n\n      if (new_h < 0) {\n        new_h = 360 + new_h;\n      } else if (new_h > 360) {\n        new_h = new_h - 360;\n      }\n\n      if (new_s < 0) {\n        new_s = new_s * -1;\n      } else if (new_s > 100) {\n        new_s = 200 - new_s;\n      }\n\n      if (new_v < 0) {\n        new_v = new_v * -1;\n      } else if (new_v > 100) {\n        new_v = 200 - new_v;\n      }\n\n      hList.push(new_h);\n      sList.push(new_s);\n      vList.push(new_v);\n    }\n\n    colorList.push([hList, sList, vList]);\n  }\n\n  var rgbList = [];\n  let hIndex, sIndex, vIndex;\n\n  for (hIndex in colorList[0][0]) {\n    for (sIndex in colorList[0][1]) {\n      for (vIndex in colorList[0][2]) {\n        var RGBs = [];\n\n        for (n = 0; n < numberOfColor; n++) {\n          RGBs.push(createRGBfromHSV(colorList[n][0][hIndex] / 360, colorList[n][1][sIndex] / 100, colorList[n][2][vIndex] / 100));\n        }\n\n        rgbList.push(RGBs);\n      }\n    }\n  }\n\n  return rgbList;\n}\n\nvar posterIndex = 0;\nvar backgroundPalette = [],\n    elementPalettePure = [],\n    elementPaletteGrad = []; //face_color/nose,ear_color/neck_color\n\nvar skinPalette = [[{\n  r: 252,\n  g: 234,\n  b: 202\n}, {\n  r: 240,\n  g: 216,\n  b: 182\n}, {\n  r: 230,\n  g: 203,\n  b: 159\n}], [{\n  r: 245,\n  g: 219,\n  b: 174\n}, {\n  r: 232,\n  g: 202,\n  b: 160\n}, {\n  r: 218,\n  g: 189,\n  b: 141\n}], [{\n  r: 228,\n  g: 196,\n  b: 142\n}, {\n  r: 214,\n  g: 178,\n  b: 133\n}, {\n  r: 204,\n  g: 166,\n  b: 113\n}]];\nvar colorRanNumber = 10,\n    colorRanRange = 5;\nbackgroundPalette.push(generateColor([[0, 0, 100]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[0, 0, 92]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[0, 0, 21]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[164, 15, 72]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[248, 36, 58]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[39, 49, 98], [331, 60, 96]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[328, 33, 100], [213, 26, 100]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[187, 43, 100], [325, 21, 100]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[171, 49, 91], [223, 44, 89]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[336, 42, 100], [222, 93, 60]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[36, 32, 99], [188, 52, 95]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[135, 64, 91], [259, 67, 96]], colorRanNumber, colorRanRange));\nbackgroundPalette.push(generateColor([[8, 25, 98], [188, 51, 85]], colorRanNumber, colorRanRange));\ncolorRanRange = 8;\nelementPalettePure.push(generateColor([[0, 0, 100]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[0, 0, 84]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[77, 13, 21]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[252, 59, 100]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[154, 37, 94]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[339, 40, 100]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[47, 78, 98]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[296, 59, 99]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[187, 45, 91]], colorRanNumber, colorRanRange));\nelementPalettePure.push(generateColor([[347, 78, 100]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[0, 0, 93], [0, 0, 47]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[51, 19, 100], [334, 45, 100]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[58, 83, 100], [326, 80, 95]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[24, 49, 100], [274, 79, 91]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[135, 64, 91], [62, 81, 96]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[135, 64, 91], [259, 67, 96]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[352, 42, 99], [183, 75, 95]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[319, 86, 89], [190, 46, 93]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[181, 80, 93], [259, 67, 96]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[207, 86, 89], [273, 82, 57]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[30, 11, 93], [23, 44, 74]], colorRanNumber, colorRanRange));\nelementPaletteGrad.push(generateColor([[187, 43, 100], [325, 21, 100]], colorRanNumber, colorRanRange)); //Rotation\n\nvar tRotation_1 = [0, 30, 60, 90, 120, 150, 180],\n    tRotation_2 = [0, 36, 72, 108, 144, 180],\n    tRotation_3 = [0, 30, 60, 90, 120, 150, 180],\n    tRotation_4 = [0, 180],\n    tRotation_5 = [0, 45, 90, 135, 180],\n    tRotation_6 = [0, 60, 90, 150, 180],\n    tRotation_7 = [0, 30, 60, 90, 120, 150, 180],\n    sRotation_1 = [0, 30, 60, 90, 120, 150, 180],\n    sRotation_2 = [0, 45, 90, 135, 180],\n    cRotation = [0, 45, 90, 135, 180]; //Layout\n\nvar width = 240,\n    height = 240;\nvar fontSizeSmall = 5,\n    fontSizeMid = 8,\n    fontSizeLarge = 10; //resize\n\nwidth /= 2;\nheight /= 2;\nfontSizeSmall /= 2;\nfontSizeMid /= 2;\nfontSizeLarge /= 2;\nvar widthSegments = 15,\n    heightSegments = 20; //position for laying texts\n\nvar textIntersection = [];\ntextIntersection[0] = [width / widthSegments * 2, height / heightSegments * 2, 0];\ntextIntersection[1] = [width / widthSegments * 17, height / heightSegments * 2, 0];\ntextIntersection[2] = [width / widthSegments * 2, height / heightSegments * 32, 0];\ntextIntersection[3] = [width / widthSegments * 17, height / heightSegments * 32, 0];\nvar coreIntersections = [],\n    normalIntersections = []; //center\n\ncoreIntersections[0] = [width / 2, height / 2, 0]; //three-folds\n\ncoreIntersections[1] = [width / 3, height / 3, 0];\ncoreIntersections[2] = [width / 3, height * 2 / 3, 0];\ncoreIntersections[3] = [width * 2 / 3, height / 3, 0];\ncoreIntersections[4] = [width * 2 / 3, height * 2 / 3, 0]; //squre-intersection\n\ncoreIntersections[5] = calIntersection(height / width, 0, -width / height, width * width / height); //coreIntersections[5].push(Math.atan(-width/height)*90)\n\ncoreIntersections[5].push(0);\ncoreIntersections[6] = calIntersection(height / width, 0, -width / height, height); //coreIntersections[6].push(Math.atan(-width/height)*90)\n\ncoreIntersections[6].push(0);\ncoreIntersections[7] = calIntersection(-height / width, height, width / height, height - width * width / height); //coreIntersections[7].push(Math.atan(width/height)*90)\n\ncoreIntersections[7].push(0);\ncoreIntersections[8] = calIntersection(-height / width, height, width / height, 0); //coreIntersections[8].push(Math.atan(width/height)*90)\n\ncoreIntersections[8].push(0);\n\nfunction calIntersection(a1, b1, a2, b2) {\n  var interPoint = []; //x\n\n  interPoint[0] = (b2 - b1) / (a1 - a2); //y\n\n  interPoint[1] = a1 * interPoint[0] + b1;\n  return interPoint;\n} // Draw white points\n// var widthGap = width/widthSegments;\n\n\nvar heightGap = height / heightSegments; // var lineStyle_2 = {width: 0.5 ,color: '#C1BAC6'}\n\nfor (var i = 1; i < widthSegments; i++) {\n  var x = heightGap * i; //draw.line(x,0,x,height).stroke(lineStyle_2)\n  //calculate interaction with horizontal lines\n\n  normalIntersections.push([x, x * height / width, Math.atan(height / width) * 90]);\n  normalIntersections.push([x, x * (-height / width) + height, Math.atan(-height / width) * 90]);\n  normalIntersections.push([x, x * (-width / height) + width * width / height, Math.atan(-width / height) * 90]);\n  normalIntersections.push([x, x * (-width / height) + height, Math.atan(-width / height) * 90]);\n  normalIntersections.push([x, x * width / height + height - width * width / height, Math.atan(width / height) * 90]);\n  normalIntersections.push([x, x * width / height, Math.atan(width / height) * 90]);\n}\n\nfor (var j = 1; j < heightSegments; j++) {\n  var y = heightGap * j; //draw.line(0,y,width,y).stroke(lineStyle_2)\n\n  normalIntersections.push([y / (height / width), y, Math.atan(height / width) * 90]);\n  normalIntersections.push([(y - height) / (-height / width), y, Math.atan(-height / width) * 90]);\n\n  if (y <= width * width / height) {\n    normalIntersections.push([(y - width * width / height) / (-width / height), y, Math.atan(-width / height) * 90]);\n    normalIntersections.push([y / (width / height), y, Math.atan(width / height) * 90]);\n  }\n\n  if (y >= height - width * width / height && y < height) {\n    normalIntersections.push([(y - height) / (-width / height), y, Math.atan(-width / height) * 90]);\n    normalIntersections.push([(y - height + width * width / height) / (width / height), y, Math.atan(width / height) * 90]);\n  }\n} // ==================================================================\n\n\nfunction loadxmlDoc(file) {\n  let xmlDoc;\n\n  try {\n    //IE\n    xmlDoc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n  } catch (e) {\n    ////Firefox, Mozilla, Opera, etc\n    xmlDoc = document.implementation.createDocument(\"\", \"\", null);\n  }\n\n  try {\n    xmlDoc.async = false;\n    xmlDoc.load(file);\n  } catch (e) {\n    // for Chrome\n    var xmlhttp = new window.XMLHttpRequest(); // console.log(xmlhttp);\n\n    xmlhttp.open(\"GET\", file, false);\n    xmlhttp.send(null);\n    xmlDoc = xmlhttp.responseXML.documentElement; // Sconsole.log(xmlDoc);\n  }\n\n  return xmlDoc;\n}\n\nvar ob = loadxmlDoc(\"/all.xml\");\nvar svg = ob.getElementsByTagName(\"svg\"); //create all possible shapes in the canvas\n\nfunction createShapes(cList, rList, tList, draw) {\n  for (var i = 0; i < svg.length; i++) {\n    var shape = draw.group();\n    let data;\n\n    if (svg[i].getElementById('triangle')) {\n      data = svg[i].getElementById('triangle').childNodes[1];\n      var transform = svg[i].getElementById('triangle').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',');\n      var point = svg[i].getElementById('point');\n      var index = parseInt(data.id.split(\"/\")[1]) + 4 + (parseInt(data.id.split(\"/\")[2]) + 4) * 9; // console.log(data.id)\n      //check if the element has transform data\n\n      if (svg[i].getElementById(data.id).getAttribute(\"transform\")) {\n        var elementTransform = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(','); // console.log(elementTransform)\n\n        transform[0] = parseFloat(transform[0]) + parseFloat(elementTransform[0]);\n        transform[1] = parseFloat(transform[1]) + parseFloat(elementTransform[1]);\n\n        if (svg[i].getElementById(data.id).getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n          var scaleValue = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',');\n          shape.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]));\n        }\n      } // set attributes of shape\n\n\n      if (point) {\n        var cx = parseFloat(point.getAttribute(\"x\"));\n        var cy = parseFloat(point.getAttribute(\"y\"));\n        shape.attr({\n          \"name\": data.id,\n          \"cx\": cx,\n          \"cy\": cy,\n          \"transform\": \"translate(\" + (parseFloat(transform[0]) - cx) + \",\" + (parseFloat(transform[1]) - cy) + \")\",\n          \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n          \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n        });\n      } else {\n        shape.attr({\n          \"name\": data.id,\n          \"transform\": \"translate(\" + (parseFloat(transform[0]) - parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) - parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n          \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n          \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n        });\n      } // set content of shape\n\n\n      if (svg[i].getElementsByTagName('path')[0]) {\n        shape.path(svg[i].getElementsByTagName('path')[0].getAttribute(\"d\"));\n      } else if (svg[i].getElementsByTagName('polygon')[0]) {\n        shape.add(draw.polygon().attr(\"points\", svg[i].getElementsByTagName('polygon')[0].getAttribute(\"points\")));\n      }\n\n      draw.defs().add(shape);\n      tList[index] = shape;\n    } else if (svg[i].getElementById('square')) {\n      data = svg[i].getElementById('square').childNodes[1];\n      var transform = svg[i].getElementById('square').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',');\n      var point = svg[i].getElementById('point');\n      var index = parseInt(data.id.split(\"/\")[1]) + 4 + (parseInt(data.id.split(\"/\")[2]) + 4) * 9; //check if the element has transform data\n\n      if (svg[i].getElementById(data.id).getAttribute(\"transform\")) {\n        var elementTransform = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(','); // console.log(elementTransform)\n\n        transform[0] = parseFloat(transform[0]) + parseFloat(elementTransform[0]);\n        transform[1] = parseFloat(transform[1]) + parseFloat(elementTransform[1]);\n\n        if (svg[i].getElementById(data.id).getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n          var scaleValue = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',');\n          shape.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]));\n        }\n      } // set attributes of shape\n\n\n      if (point) {\n        var cx = parseFloat(point.getAttribute(\"x\"));\n        var cy = parseFloat(point.getAttribute(\"y\"));\n        shape.attr({\n          \"name\": data.id,\n          \"cx\": cx,\n          \"cy\": cy,\n          \"transform\": \"translate(\" + (parseFloat(transform[0]) - cx) + \",\" + (parseFloat(transform[1]) - cy) + \")\",\n          \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n          \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n        });\n      } else {\n        shape.attr({\n          \"name\": data.id,\n          \"transform\": \"translate(\" + (parseFloat(transform[0]) - parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) - parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n          \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n          \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n        });\n      } // set content of shape\n\n\n      if (svg[i].getElementsByTagName('path')[0]) {\n        shape.path(svg[i].getElementsByTagName('path')[0].getAttribute(\"d\"));\n      } else if (svg[i].getElementsByTagName('polygon')[0]) {\n        shape.add(draw.polygon().attr(\"points\", svg[i].getElementsByTagName('polygon')[0].getAttribute(\"points\")));\n      }\n\n      draw.defs().add(shape);\n      rList[index] = shape;\n    } else if (svg[i].getElementById('circular')) {\n      data = svg[i].getElementById('circular').childNodes[1];\n      var transform = svg[i].getElementById('circular').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',');\n      var point = svg[i].getElementById('point');\n      var index = parseInt(data.id.split(\"/\")[1]) + 4 + (parseInt(data.id.split(\"/\")[2]) + 4) * 9; //check if the element has transform data\n\n      if (svg[i].getElementById(data.id).getAttribute(\"transform\")) {\n        var elementTransform = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(','); // console.log(elementTransform)\n\n        transform[0] = parseFloat(transform[0]) + parseFloat(elementTransform[0]);\n        transform[1] = parseFloat(transform[1]) + parseFloat(elementTransform[1]);\n\n        if (svg[i].getElementById(data.id).getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n          var scaleValue = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',');\n          shape.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]));\n        }\n      } // set attributes of shape\n\n\n      if (point) {\n        var cx = parseFloat(point.getAttribute(\"x\"));\n        var cy = parseFloat(point.getAttribute(\"y\"));\n        shape.attr({\n          \"name\": data.id,\n          \"cx\": cx,\n          \"cy\": cy,\n          \"transform\": \"translate(\" + (parseFloat(transform[0]) - cx) + \",\" + (parseFloat(transform[1]) - cy) + \")\",\n          \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n          \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n        });\n      } else {\n        shape.attr({\n          \"name\": data.id,\n          \"transform\": \"translate(\" + (parseFloat(transform[0]) - parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) - parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n          \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n          \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n        });\n      } // set content of shape\n\n\n      if (svg[i].getElementsByTagName('path')[0]) {\n        shape.path(svg[i].getElementsByTagName('path')[0].getAttribute(\"d\"));\n      } else if (svg[i].getElementsByTagName('ellipse')[0]) {\n        shape.add(draw.ellipse().attr({\n          \"cx\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"cx\"),\n          \"cy\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"cy\"),\n          \"rx\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"rx\"),\n          \"ry\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"ry\")\n        }));\n      } else if (svg[i].getElementsByTagName('circle')[0]) {\n        shape.add(draw.circle().attr({\n          \"cx\": svg[i].getElementsByTagName('circle')[0].getAttribute(\"cx\"),\n          \"cy\": svg[i].getElementsByTagName('circle')[0].getAttribute(\"cy\"),\n          \"r\": svg[i].getElementsByTagName('circle')[0].getAttribute(\"r\")\n        }));\n      }\n\n      draw.defs().add(shape);\n      cList[index] = shape;\n    }\n  }\n}\n\nvar drawList = []; //Define the number of deatures for each shape\n// const NUM_SHAPE_FEATURES=15,\n// \t  MAX_ELEMENTS = 18,\n// \t  NUM_PEOPLE_FEATURES = 17,\n// \t  NUM_TEXT_FEATURES =1,\n// \t  NUM_BG_FEATURES = 6;\n\nconst NUM_ELEMENT_TYPE = 3,\n      NUM_ELEMENT_X = 9,\n      NUM_ELEMENT_Y = 9;\n\nfunction rotate(shape, index) {\n  var randomRotation = index;\n  var shapeName = shape.node.attributes.name.nodeValue.split(\"/\");\n  var rotationAngel;\n\n  if (shapeName[0] === \"t\") {\n    if (parseInt(shapeName[1]) === -4) {\n      rotationAngel = tRotation_1[parseInt(tRotation_1.length * randomRotation)];\n    } else if (parseInt(shapeName[1]) === -3) {\n      rotationAngel = tRotation_2[parseInt(tRotation_2.length * randomRotation)];\n    } else if (parseInt(shapeName[1]) === -2 || parseInt(shapeName[1]) === -1 || parseInt(shapeName[1]) === 0) {\n      rotationAngel = tRotation_3[parseInt(tRotation_3.length * randomRotation)];\n    } else if (parseInt(shapeName[1]) === 1) {\n      rotationAngel = tRotation_4[parseInt(tRotation_4.length * randomRotation)];\n    } else if (parseInt(shapeName[1]) === 2) {\n      rotationAngel = tRotation_5[parseInt(tRotation_5.length * randomRotation)];\n    } else if (parseInt(shapeName[1]) === 3) {\n      rotationAngel = tRotation_6[parseInt(tRotation_6.length * randomRotation)];\n    } else if (parseInt(shapeName[1]) === 4) {\n      rotationAngel = tRotation_7[parseInt(tRotation_7.length * randomRotation)];\n    }\n  } //\n  else if (shapeName[0] === \"s\") {\n      if (parseInt(shapeName[1]) >= -4 && parseInt(shapeName[1]) <= -1) {\n        rotationAngel = sRotation_1[parseInt(sRotation_1.length * randomRotation)];\n      } else if (parseInt(shapeName[1]) >= 0 && parseInt(shapeName[1]) <= 4) {\n        rotationAngel = sRotation_2[parseInt(sRotation_2.length * randomRotation)];\n      }\n    } else if (shapeName[0] === \"c\") {\n      rotationAngel = cRotation[parseInt(cRotation.length * randomRotation)];\n    }\n\n  if (shape.attr(\"cx\") && shape.attr(\"cy\")) {\n    shape.rotate(rotationAngel, shape.attr(\"cx\"), shape.attr(\"cy\"));\n  } else {\n    shape.rotate(rotationAngel);\n  }\n\n  return randomRotation;\n}\n\nvar div = document.createElement(\"div\");\ndiv.setAttribute(\"id\", \"container\"); // 被选中的海报\n\nvar choosed = null;\n\nvar _draw = SVG('test').size(width, height);\n\nvar _circleList = [],\n    _rectList = [],\n    _triList = [];\ncreateShapes(_circleList, _rectList, _triList, _draw);\n\nfunction zoomPoster(csvdata) {\n  var draw = SVG(\"choosed\").size(width, height);\n\n  var circleList = _circleList.concat(),\n      rectList = _rectList.concat(),\n      triList = _triList.concat();\n\n  var shapeList = triList.concat(rectList, circleList);\n  var bgGradient = draw.gradient('linear', function (stop) {\n    var bgHSV = csvdata[csvdata.length - 1];\n    stop.at(0, createRGBfromHSV(bgHSV.data[0], bgHSV.data[1], bgHSV.data[2]));\n    stop.at(1, createRGBfromHSV(bgHSV.data[3], bgHSV.data[4], bgHSV.data[5]));\n  });\n  bgGradient.from(\"0%\", \"0%\").to(\"0%\", \"100%\");\n  draw.rect(width, height).fill(bgGradient); // let start = new Date().getTime();\n\n  for (var i = 0; i < csvdata.length; i++) {\n    if (csvdata[i].name === \"element\") {\n      var shapeNormalX = Math.round((NUM_ELEMENT_TYPE - 1) * csvdata[i].data[0]),\n          shapeNormalY = Math.round((NUM_ELEMENT_X - 1) * csvdata[i].data[1]),\n          shapeNormalZ = Math.round((NUM_ELEMENT_Y - 1) * csvdata[i].data[2]);\n      var elementColor = draw.gradient('linear', function (stop) {\n        stop.at(0, createRGBfromHSV(csvdata[i].data[7], csvdata[i].data[8], csvdata[i].data[9]));\n        stop.at(1, createRGBfromHSV(csvdata[i].data[10], csvdata[i].data[11], csvdata[i].data[12]));\n      });\n      elementColor.from(\"0%\", \"0%\").to(\"0%\", \"100%\");\n      var shapeNormal = shapeList[shapeNormalX * NUM_ELEMENT_X * NUM_ELEMENT_Y + NUM_ELEMENT_X * shapeNormalY + shapeNormalZ].clone();\n      var shapeScale = Math.sqrt(width * height * csvdata[i].data[3] / (shapeNormal.width() * shapeNormal.height()));\n      draw.use(shapeNormal);\n      shapeNormal.dx(width * csvdata[i].data[4]).dy(height * csvdata[i].data[5]);\n      rotate(shapeNormal, csvdata[i].data[6]);\n      shapeNormal.scale(shapeScale, shapeScale).fill(elementColor).opacity(parseFloat(csvdata[i].data[13]));\n    }\n  }\n\n  draw.scale(550 / 120);\n  draw.translate(200, 200);\n}\n\nfunction favPoster(csvdata, num) {\n  // var subdiv = document.createElement(\"div\");\n  // subdiv.setAttribute(\"id\", \"poster\"+num);\n  // subdiv.setAttribute(\"class\", \"poster\");\n  // div.appendChild(subdiv)\n  // document.body.appendChild(div);\n  // console.log(pnt.state);\n  var draw = SVG('favorite' + num).size(width, height);\n\n  var circleList = _circleList.concat(),\n      rectList = _rectList.concat(),\n      triList = _triList.concat();\n\n  var shapeList = triList.concat(rectList, circleList);\n  var bgGradient = draw.gradient('linear', function (stop) {\n    var bgHSV = csvdata[csvdata.length - 1];\n    stop.at(0, createRGBfromHSV(bgHSV.data[0], bgHSV.data[1], bgHSV.data[2]));\n    stop.at(1, createRGBfromHSV(bgHSV.data[3], bgHSV.data[4], bgHSV.data[5]));\n  });\n  bgGradient.from(\"0%\", \"0%\").to(\"0%\", \"100%\");\n  draw.rect(width, height).fill(bgGradient); // let start = new Date().getTime();\n\n  for (var i = 0; i < csvdata.length; i++) {\n    if (csvdata[i].name === \"element\") {\n      var shapeNormalX = Math.round((NUM_ELEMENT_TYPE - 1) * csvdata[i].data[0]),\n          shapeNormalY = Math.round((NUM_ELEMENT_X - 1) * csvdata[i].data[1]),\n          shapeNormalZ = Math.round((NUM_ELEMENT_Y - 1) * csvdata[i].data[2]);\n      var elementColor = draw.gradient('linear', function (stop) {\n        stop.at(0, createRGBfromHSV(csvdata[i].data[7], csvdata[i].data[8], csvdata[i].data[9]));\n        stop.at(1, createRGBfromHSV(csvdata[i].data[10], csvdata[i].data[11], csvdata[i].data[12]));\n      });\n      elementColor.from(\"0%\", \"0%\").to(\"0%\", \"100%\"); // console.log(shapeList)\n      // console.log(shapeNormalX,shapeNormalY,shapeNormalZ,shapeNormalX*NUM_ELEMENT_X*NUM_ELEMENT_Y+NUM_ELEMENT_X*shapeNormalY+shapeNormalZ)\n\n      var shapeNormal = shapeList[shapeNormalX * NUM_ELEMENT_X * NUM_ELEMENT_Y + NUM_ELEMENT_X * shapeNormalY + shapeNormalZ].clone();\n      var shapeScale = Math.sqrt(width * height * csvdata[i].data[3] / (shapeNormal.width() * shapeNormal.height()));\n      draw.use(shapeNormal); // console.log(width*csvdata[i].data[4],height*csvdata[i].data[5],shapeScale,parseFloat(csvdata[i].data[13]))\n\n      shapeNormal.dx(width * csvdata[i].data[4]).dy(height * csvdata[i].data[5]);\n      rotate(shapeNormal, csvdata[i].data[6]);\n      shapeNormal.scale(shapeScale, shapeScale).fill(elementColor).opacity(parseFloat(csvdata[i].data[13]));\n    }\n  }\n} // 生成海报，并为每一张海报添加click函数\n\n\nfunction createPoster(csvdata, num, isExtended) {\n  // var subdiv = document.createElement(\"div\");\n  // subdiv.setAttribute(\"id\", \"poster\"+num);\n  // subdiv.setAttribute(\"class\", \"poster\");\n  // div.appendChild(subdiv)\n  // document.body.appendChild(div);\n  // console.log(pnt.state);\n  if (isExtended) var draw = SVG('square' + num).size(width, height);else var draw = SVG('poster' + num).size(width, height);\n\n  var circleList = _circleList.concat(),\n      rectList = _rectList.concat(),\n      triList = _triList.concat();\n\n  var shapeList = triList.concat(rectList, circleList);\n  var bgGradient = draw.gradient('linear', function (stop) {\n    var bgHSV = csvdata[csvdata.length - 1];\n    stop.at(0, createRGBfromHSV(bgHSV.data[0], bgHSV.data[1], bgHSV.data[2]));\n    stop.at(1, createRGBfromHSV(bgHSV.data[3], bgHSV.data[4], bgHSV.data[5]));\n  });\n  bgGradient.from(\"0%\", \"0%\").to(\"0%\", \"100%\");\n  draw.rect(width, height).fill(bgGradient); // let start = new Date().getTime();\n\n  for (var i = 0; i < csvdata.length; i++) {\n    if (csvdata[i].name === \"element\") {\n      var shapeNormalX = Math.round((NUM_ELEMENT_TYPE - 1) * csvdata[i].data[0]),\n          shapeNormalY = Math.round((NUM_ELEMENT_X - 1) * csvdata[i].data[1]),\n          shapeNormalZ = Math.round((NUM_ELEMENT_Y - 1) * csvdata[i].data[2]);\n      var elementColor = draw.gradient('linear', function (stop) {\n        stop.at(0, createRGBfromHSV(csvdata[i].data[7], csvdata[i].data[8], csvdata[i].data[9]));\n        stop.at(1, createRGBfromHSV(csvdata[i].data[10], csvdata[i].data[11], csvdata[i].data[12]));\n      });\n      elementColor.from(\"0%\", \"0%\").to(\"0%\", \"100%\"); // console.log(shapeList)\n      // console.log(shapeNormalX,shapeNormalY,shapeNormalZ,shapeNormalX*NUM_ELEMENT_X*NUM_ELEMENT_Y+NUM_ELEMENT_X*shapeNormalY+shapeNormalZ)\n\n      var shapeNormal = shapeList[shapeNormalX * NUM_ELEMENT_X * NUM_ELEMENT_Y + NUM_ELEMENT_X * shapeNormalY + shapeNormalZ].clone();\n      var shapeScale = Math.sqrt(width * height * csvdata[i].data[3] / (shapeNormal.width() * shapeNormal.height()));\n      draw.use(shapeNormal); // console.log(width*csvdata[i].data[4],height*csvdata[i].data[5],shapeScale,parseFloat(csvdata[i].data[13]))\n\n      shapeNormal.dx(width * csvdata[i].data[4]).dy(height * csvdata[i].data[5]);\n      rotate(shapeNormal, csvdata[i].data[6]);\n      shapeNormal.scale(shapeScale, shapeScale).fill(elementColor).opacity(parseFloat(csvdata[i].data[13]));\n    }\n  } // console.log('for:')\n  // console.log(new Date().getTime()-start);\n  // drawList.push(draw);\n  // draw.attr('num', num);\n  // draw.click(function () {\n  //     //document.getElementById(\"audio-click\").play();\n  //\n  //     // 点击海报则放大显示\n  //     document.getElementById('chooseposter').style.display = 'block';\n  //     document.getElementById('overlay0').style.display = 'block';\n  //     if (choosed === null)\n  //         choosed = SVG(\"choosed\").fill('#0f4');\n  //     choosed.svg(draw.svg());\n  //     choosed.attr({\n  //         'num': num\n  //     });\n  //     choosed.scale(4.92);\n  //     choosed.translate(1294, 1559);\n  //     // pnt.setState({\n  //     //     num: draw.attr('num')\n  //     // });\n  //\n  //     // 添加放大动画\n  //     $(\"#chooseposter\").addClass(\"choose-poster-ani\");\n  // })\n\n}\n\nfunction setChoosedNull() {\n  choosed = null;\n} // // 生成“输入名字”页面的卡片上的海报\n// function createCardPoster(csvdata) {\n//     width *= 4.92;\n//     height *= 4.92;\n//     fontSizeSmall *= 4.92;\n//     fontSizeMid *= 4.92;\n//     fontSizeLarge *= 4.92;\n//     var draw = SVG('cardPoster').size(width, height);\n//\n//     // var circleList = _circleList.concat(), rectList = _rectList.concat(), triList = _triList.concat(), peopleList = _peopleList.concat()\n//     var circleList = [],\n//         rectList = [],\n//         triList = [];\n//\n//     createShapes(circleList, rectList, triList, draw)\n//\n//     var shapeList = triList.concat(rectList, circleList)\n//\n//     var bgGradient = draw.gradient('linear', function (stop) {\n//         var bgHSV = csvdata[csvdata.length - 1]\n//         stop.at(0, createRGBfromHSV(bgHSV.data[0], bgHSV.data[1], bgHSV.data[2]))\n//         stop.at(1, createRGBfromHSV(bgHSV.data[3], bgHSV.data[4], bgHSV.data[5]))\n//     })\n//     bgGradient.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n//     draw.rect(width, height).fill(bgGradient)\n//     // let start = new Date().getTime();\n//     for (var i = 0; i < csvdata.length; i++) {\n//         if (csvdata[i].name === \"element\") {\n//             var shapeNormalX = Math.round((NUM_ELEMENT_TYPE - 1) * csvdata[i].data[0]),\n//                 shapeNormalY = Math.round((NUM_ELEMENT_X - 1) * csvdata[i].data[1]),\n//                 shapeNormalZ = Math.round((NUM_ELEMENT_Y - 1) * csvdata[i].data[2]);\n//\n//             var elementColor = draw.gradient('linear', function (stop) {\n//                 stop.at(0, createRGBfromHSV(csvdata[i].data[7], csvdata[i].data[8], csvdata[i].data[9]))\n//                 stop.at(1, createRGBfromHSV(csvdata[i].data[10], csvdata[i].data[11], csvdata[i].data[12]))\n//             })\n//             elementColor.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n//\n//             // console.log(shapeList)\n//             //console.log(shapeNormalX,shapeNormalY,shapeNormalZ,shapeNormalX*NUM_ELEMENT_X*NUM_ELEMENT_Y+NUM_ELEMENT_X*shapeNormalY+shapeNormalZ)\n//\n//             var shapeNormal = shapeList[shapeNormalX * NUM_ELEMENT_X * NUM_ELEMENT_Y + NUM_ELEMENT_X * shapeNormalY + shapeNormalZ].clone()\n//\n//             var shapeScale = Math.sqrt((width * height) * csvdata[i].data[3] / (shapeNormal.width() * shapeNormal.height()))\n//\n//             draw.use(shapeNormal)\n//\n//             // console.log(width*csvdata[i].data[4],height*csvdata[i].data[5],shapeScale,parseFloat(csvdata[i].data[13]))\n//\n//             shapeNormal\n//                 .dx(width * csvdata[i].data[4])\n//                 .dy(height * csvdata[i].data[5])\n//\n//             rotate(shapeNormal, csvdata[i].data[6])\n//\n//             shapeNormal\n//                 .scale(shapeScale, shapeScale)\n//                 .fill(elementColor)\n//                 .opacity(parseFloat(csvdata[i].data[13]))\n//         }\n//     }\n//\n// }\n\n\nvar posterList = [];\nvar div; // 获取到服务器返回的csv文件后的回调函数\n\nvar features = [];\nvar features2 = [];\nvar noises = [];\nvar noises2 = [];\n\nfunction constructPoster(featureData, isExtended) {\n  for (var i = 0; i < featureData.length; i++) {\n    var element = {\n      \"data\": featureData[i].slice(0, 15),\n      \"index\": featureData[i][14],\n      \"name\": \"element\"\n    },\n        element2 = {\n      \"data\": featureData[i].slice(15, 30),\n      \"index\": featureData[i][29],\n      \"name\": \"element\"\n    },\n        element3 = {\n      \"data\": featureData[i].slice(30, 45),\n      \"index\": featureData[i][44],\n      \"name\": \"element\"\n    },\n        element4 = {\n      \"data\": featureData[i].slice(45, 60),\n      \"index\": featureData[i][59],\n      \"name\": \"element\"\n    },\n        element5 = {\n      \"data\": featureData[i].slice(60, 75),\n      \"index\": featureData[i][74],\n      \"name\": \"element\"\n    },\n        element6 = {\n      \"data\": featureData[i].slice(75, 90),\n      \"index\": featureData[i][89],\n      \"name\": \"element\"\n    },\n        element7 = {\n      \"data\": featureData[i].slice(90, 105),\n      \"index\": featureData[i][104],\n      \"name\": \"element\"\n    },\n        element8 = {\n      \"data\": featureData[i].slice(105, 120),\n      \"index\": featureData[i][119],\n      \"name\": \"element\"\n    },\n        element9 = {\n      \"data\": featureData[i].slice(120, 135),\n      \"index\": featureData[i][134],\n      \"name\": \"element\"\n    },\n        element10 = {\n      \"data\": featureData[i].slice(135, 150),\n      \"index\": featureData[i][149],\n      \"name\": \"element\"\n    },\n        element11 = {\n      \"data\": featureData[i].slice(150, 165),\n      \"index\": featureData[i][164],\n      \"name\": \"element\"\n    },\n        element12 = {\n      \"data\": featureData[i].slice(165, 180),\n      \"index\": featureData[i][179],\n      \"name\": \"element\"\n    },\n        element13 = {\n      \"data\": featureData[i].slice(180, 195),\n      \"index\": featureData[i][194],\n      \"name\": \"element\"\n    },\n        element14 = {\n      \"data\": featureData[i].slice(195, 210),\n      \"index\": featureData[i][209],\n      \"name\": \"element\"\n    },\n        element15 = {\n      \"data\": featureData[i].slice(210, 225),\n      \"index\": featureData[i][224],\n      \"name\": \"element\"\n    },\n        element16 = {\n      \"data\": featureData[i].slice(225, 240),\n      \"index\": featureData[i][239],\n      \"name\": \"element\"\n    },\n        element17 = {\n      \"data\": featureData[i].slice(240, 255),\n      \"index\": featureData[i][254],\n      \"name\": \"element\"\n    },\n        element18 = {\n      \"data\": featureData[i].slice(255, 270),\n      \"index\": featureData[i][269],\n      \"name\": \"element\"\n    },\n        bg = {\n      \"data\": featureData[i].slice(270, 276),\n      \"name\": \"bg\"\n    };\n    var poster = [element, element2, element3, element4, element5, element6, element7, element8, element9, element10, element11, element12, element13, element14, element15, element16, element17, element18, bg];\n    createPoster(poster, i, isExtended);\n    posterList.push(poster);\n  }\n}\n\nfunction constructPoster2(featureData) {\n  var element = {\n    \"data\": featureData.slice(0, 15),\n    \"index\": featureData[14],\n    \"name\": \"element\"\n  },\n      element2 = {\n    \"data\": featureData.slice(15, 30),\n    \"index\": featureData[29],\n    \"name\": \"element\"\n  },\n      element3 = {\n    \"data\": featureData.slice(30, 45),\n    \"index\": featureData[44],\n    \"name\": \"element\"\n  },\n      element4 = {\n    \"data\": featureData.slice(45, 60),\n    \"index\": featureData[59],\n    \"name\": \"element\"\n  },\n      element5 = {\n    \"data\": featureData.slice(60, 75),\n    \"index\": featureData[74],\n    \"name\": \"element\"\n  },\n      element6 = {\n    \"data\": featureData.slice(75, 90),\n    \"index\": featureData[89],\n    \"name\": \"element\"\n  },\n      element7 = {\n    \"data\": featureData.slice(90, 105),\n    \"index\": featureData[104],\n    \"name\": \"element\"\n  },\n      element8 = {\n    \"data\": featureData.slice(105, 120),\n    \"index\": featureData[119],\n    \"name\": \"element\"\n  },\n      element9 = {\n    \"data\": featureData.slice(120, 135),\n    \"index\": featureData[134],\n    \"name\": \"element\"\n  },\n      element10 = {\n    \"data\": featureData.slice(135, 150),\n    \"index\": featureData[149],\n    \"name\": \"element\"\n  },\n      element11 = {\n    \"data\": featureData.slice(150, 165),\n    \"index\": featureData[164],\n    \"name\": \"element\"\n  },\n      element12 = {\n    \"data\": featureData.slice(165, 180),\n    \"index\": featureData[179],\n    \"name\": \"element\"\n  },\n      element13 = {\n    \"data\": featureData.slice(180, 195),\n    \"index\": featureData[194],\n    \"name\": \"element\"\n  },\n      element14 = {\n    \"data\": featureData.slice(195, 210),\n    \"index\": featureData[209],\n    \"name\": \"element\"\n  },\n      element15 = {\n    \"data\": featureData.slice(210, 225),\n    \"index\": featureData[224],\n    \"name\": \"element\"\n  },\n      element16 = {\n    \"data\": featureData.slice(225, 240),\n    \"index\": featureData[239],\n    \"name\": \"element\"\n  },\n      element17 = {\n    \"data\": featureData.slice(240, 255),\n    \"index\": featureData[254],\n    \"name\": \"element\"\n  },\n      element18 = {\n    \"data\": featureData.slice(255, 270),\n    \"index\": featureData[269],\n    \"name\": \"element\"\n  },\n      bg = {\n    \"data\": featureData.slice(270, 276),\n    \"name\": \"bg\"\n  };\n  var poster = [element, element2, element3, element4, element5, element6, element7, element8, element9, element10, element11, element12, element13, element14, element15, element16, element17, element18, bg];\n  zoomPoster(poster);\n}\n\nfunction getDataCallback(data, containedNoise, isExtended, selectedID) {\n  // $.get(\"/test.csv\",function(data){\n  // console.log(data);\n  if (isExtended) {\n    $(\".square2\").empty();\n    features2 = csv2array(data);\n\n    for (var f in features2) {\n      //\n      for (var g in features2[f]) {\n        features2[f][g] = parseFloat(features2[f][g]);\n      }\n\n      noises2[f] = features2[f].slice(0, 39);\n      features2[f] = features2[f].slice(39);\n    }\n\n    if (selectedID) {\n      for (var index in selectedID) {\n        features2.push(features[selectedID[index]]);\n      }\n    }\n\n    constructPoster(features2, isExtended);\n  } else {\n    $(\".postersamples\").empty();\n    features = csv2array(data);\n\n    if (containedNoise) {\n      for (var f in features) {\n        //\n        for (var g in features[f]) {\n          features[f][g] = parseFloat(features[f][g]);\n        }\n\n        noises[f] = features[f].slice(0, 39);\n        features[f] = features[f].slice(39);\n      }\n    } else {\n      for (var f in features) {\n        //\n        for (var g in features[f]) {\n          features[f][g] = parseFloat(features[f][g]);\n        }\n      }\n    }\n\n    constructPoster(features, isExtended);\n  }\n}\n\nfunction getfavorite(featureData) {\n  $(\"#favorite1, #favorite2, #favorite3, #favorite4\").empty();\n\n  for (var i = 0; i < featureData.length; i++) {\n    var element = {\n      \"data\": featureData[i].slice(0, 15),\n      \"index\": featureData[i][14],\n      \"name\": \"element\"\n    },\n        element2 = {\n      \"data\": featureData[i].slice(15, 30),\n      \"index\": featureData[i][29],\n      \"name\": \"element\"\n    },\n        element3 = {\n      \"data\": featureData[i].slice(30, 45),\n      \"index\": featureData[i][44],\n      \"name\": \"element\"\n    },\n        element4 = {\n      \"data\": featureData[i].slice(45, 60),\n      \"index\": featureData[i][59],\n      \"name\": \"element\"\n    },\n        element5 = {\n      \"data\": featureData[i].slice(60, 75),\n      \"index\": featureData[i][74],\n      \"name\": \"element\"\n    },\n        element6 = {\n      \"data\": featureData[i].slice(75, 90),\n      \"index\": featureData[i][89],\n      \"name\": \"element\"\n    },\n        element7 = {\n      \"data\": featureData[i].slice(90, 105),\n      \"index\": featureData[i][104],\n      \"name\": \"element\"\n    },\n        element8 = {\n      \"data\": featureData[i].slice(105, 120),\n      \"index\": featureData[i][119],\n      \"name\": \"element\"\n    },\n        element9 = {\n      \"data\": featureData[i].slice(120, 135),\n      \"index\": featureData[i][134],\n      \"name\": \"element\"\n    },\n        element10 = {\n      \"data\": featureData[i].slice(135, 150),\n      \"index\": featureData[i][149],\n      \"name\": \"element\"\n    },\n        element11 = {\n      \"data\": featureData[i].slice(150, 165),\n      \"index\": featureData[i][164],\n      \"name\": \"element\"\n    },\n        element12 = {\n      \"data\": featureData[i].slice(165, 180),\n      \"index\": featureData[i][179],\n      \"name\": \"element\"\n    },\n        element13 = {\n      \"data\": featureData[i].slice(180, 195),\n      \"index\": featureData[i][194],\n      \"name\": \"element\"\n    },\n        element14 = {\n      \"data\": featureData[i].slice(195, 210),\n      \"index\": featureData[i][209],\n      \"name\": \"element\"\n    },\n        element15 = {\n      \"data\": featureData[i].slice(210, 225),\n      \"index\": featureData[i][224],\n      \"name\": \"element\"\n    },\n        element16 = {\n      \"data\": featureData[i].slice(225, 240),\n      \"index\": featureData[i][239],\n      \"name\": \"element\"\n    },\n        element17 = {\n      \"data\": featureData[i].slice(240, 255),\n      \"index\": featureData[i][254],\n      \"name\": \"element\"\n    },\n        element18 = {\n      \"data\": featureData[i].slice(255, 270),\n      \"index\": featureData[i][269],\n      \"name\": \"element\"\n    },\n        bg = {\n      \"data\": featureData[i].slice(270, 276),\n      \"name\": \"bg\"\n    };\n    var poster = [element, element2, element3, element4, element5, element6, element7, element8, element9, element10, element11, element12, element13, element14, element15, element16, element17, element18, bg];\n    favPoster(poster, i);\n  }\n}\n\nexport { _circleList, _rectList, _triList, height, width, features, features2, noises, noises2 };\nexport { choosed, posterList, setChoosedNull };\nexport { createPoster, createShapes, getDataCallback, constructPoster2, getfavorite };","map":{"version":3,"sources":["/Users/yucheng/WebstormProjects/user-research-prototype/src/autobg/generator.js"],"names":["SVG","$","csv2array","data","delimeter","undefined","length","newline","eof","i","c","charAt","row","col","array","value","cnext","push","createRGBfromHSV","h","s","v","r","g","b","f","p","q","t","arguments","Math","floor","round","getNumberInNormalDistribution","std_dev","offset","randomNormalDistribution","u","w","random","sqrt","log","generateColor","colors","number","numberOfColor","colorList","n","hList","sList","vList","k","new_h","new_s","new_v","rgbList","hIndex","sIndex","vIndex","RGBs","posterIndex","backgroundPalette","elementPalettePure","elementPaletteGrad","skinPalette","colorRanNumber","colorRanRange","tRotation_1","tRotation_2","tRotation_3","tRotation_4","tRotation_5","tRotation_6","tRotation_7","sRotation_1","sRotation_2","cRotation","width","height","fontSizeSmall","fontSizeMid","fontSizeLarge","widthSegments","heightSegments","textIntersection","coreIntersections","normalIntersections","calIntersection","a1","b1","a2","b2","interPoint","heightGap","x","atan","j","y","loadxmlDoc","file","xmlDoc","window","ActiveXObject","e","document","implementation","createDocument","async","load","xmlhttp","XMLHttpRequest","open","send","responseXML","documentElement","ob","svg","getElementsByTagName","createShapes","cList","rList","tList","draw","shape","group","getElementById","childNodes","transform","getAttribute","match","split","point","index","parseInt","id","elementTransform","parseFloat","indexOf","scaleValue","scale","cx","cy","attr","path","add","polygon","defs","ellipse","circle","drawList","NUM_ELEMENT_TYPE","NUM_ELEMENT_X","NUM_ELEMENT_Y","rotate","randomRotation","shapeName","node","attributes","name","nodeValue","rotationAngel","div","createElement","setAttribute","choosed","_draw","size","_circleList","_rectList","_triList","zoomPoster","csvdata","circleList","concat","rectList","triList","shapeList","bgGradient","gradient","stop","bgHSV","at","from","to","rect","fill","shapeNormalX","shapeNormalY","shapeNormalZ","elementColor","shapeNormal","clone","shapeScale","use","dx","dy","opacity","translate","favPoster","num","createPoster","isExtended","setChoosedNull","posterList","features","features2","noises","noises2","constructPoster","featureData","element","slice","element2","element3","element4","element5","element6","element7","element8","element9","element10","element11","element12","element13","element14","element15","element16","element17","element18","bg","poster","constructPoster2","getDataCallback","containedNoise","selectedID","empty","getfavorite"],"mappings":"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","sourcesContent":["/*\n * @Author: 王志伟\n * @Date: 2019-07-19 16:39:16\n * @Last Modified by: 王志伟\n * @Last Modified time: 2019-07-26 14:17:34\n * @Content: 生成海报。其中只更改了createPoster函数，添加了createCardPoster函数，其他与原代码相同。\n */\nimport * as SVG from 'svg.js'\nimport $ from 'jquery'\n\n\n\nfunction csv2array(data, delimeter) {\n    // Retrieve the delimeter\n    if (delimeter === undefined)\n        delimeter = ',';\n    if (delimeter && delimeter.length > 1)\n        delimeter = ',';\n\n    // initialize variables\n    var newline = '\\n';\n    var eof = '';\n    var i = 0;\n    var c = data.charAt(i);\n    var row = 0;\n    var col = 0;\n    var array = [];\n\n    while (c !== eof) {\n        // skip whitespaces\n        while (c === ' ' || c === '\\t' || c === '\\r') {\n            c = data.charAt(++i); // read next char\n        }\n\n        // get value\n        var value = \"\";\n        if (c === '\"') {\n            // value enclosed by double-quotes\n            c = data.charAt(++i);\n\n            do {\n                if (c !== '\"') {\n                    // read a regular character and go to the next character\n                    value += c;\n                    c = data.charAt(++i);\n                }\n\n                if (c === '\"') {\n                    // check for escaped double-quote\n                    var cnext = data.charAt(i + 1);\n                    if (cnext === '\"') {\n                        // this is an escaped double-quote.\n                        // Add a double-quote to the value, and move two characters ahead.\n                        value += '\"';\n                        i += 2;\n                        c = data.charAt(i);\n                    }\n                }\n            }\n            while (c !== eof && c !== '\"');\n\n            if (c === eof) {\n                throw \"Unexpected end of data, double-quote expected\";\n            }\n\n            c = data.charAt(++i);\n        } else {\n            // value without quotes\n            while (c !== eof && c !== delimeter && c !== newline && c !== ' ' && c !== '\\t' && c !== '\\r') {\n                value += c;\n                c = data.charAt(++i);\n            }\n        }\n\n        // add the value to the array\n        if (array.length <= row)\n            array.push([]);\n        array[row].push(value);\n\n        // skip whitespaces\n        while (c === ' ' || c === '\\t' || c === '\\r') {\n            c = data.charAt(++i);\n        }\n\n        // go to the next row or column\n        if (c === delimeter) {\n            // to the next column\n            col = col + 1;\n        } else if (c === newline) {\n            // to the next row\n            col = 0;\n            row++;\n        } else if (c !== eof) {\n            // unexpected character\n            throw \"Delimiter expected after character \" + i;\n        }\n\n        // go to the next character\n        c = data.charAt(++i);\n    }\n\n    return array;\n}\n\nfunction createRGBfromHSV(h, s, v) {\n    var r, g, b, i, f, p, q, t;\n    if (arguments.length === 1) {\n        s = h.s;\n        v = h.v;\n        h = h.h;\n    }\n    i = Math.floor(h * 6);\n    f = h * 6 - i;\n    p = v * (1 - s);\n    q = v * (1 - f * s);\n    t = v * (1 - (1 - f) * s);\n    switch (i % 6) {\n        case 0:\n            r = v;\n            g = t;\n            b = p;\n            break;\n        case 1:\n            r = q;\n            g = v;\n            b = p;\n            break;\n        case 2:\n            r = p;\n            g = v;\n            b = t;\n            break;\n        case 3:\n            r = p;\n            g = q;\n            b = v;\n            break;\n        case 4:\n            r = t;\n            g = p;\n            b = v;\n            break;\n        case 5:\n            r = v;\n            g = p;\n            b = q;\n            break;\n        default:\n            break;\n    }\n    return {\n        r: Math.round(r * 255),\n        g: Math.round(g * 255),\n        b: Math.round(b * 255)\n    };\n}\n\n\nfunction getNumberInNormalDistribution(std_dev) {\n    var offset = randomNormalDistribution() * std_dev;\n    return offset;\n}\n\nfunction randomNormalDistribution() {\n    var u = 0.0,\n        v = 0.0,\n        w = 0.0,\n        c = 0.0;\n    do {\n        u = Math.random() * 2 - 1.0;\n        v = Math.random() * 2 - 1.0;\n        w = u * u + v * v;\n    } while (w === 0.0 || w >= 1.0)\n    c = Math.sqrt((-2 * Math.log(w)) / w);\n    return u * c;\n}\n\nfunction generateColor(colors, number, std_dev) {\n    var numberOfColor = colors.length;\n\n    var colorList = [];\n\n    for (var n = 0; n < colors.length; n++) {\n\n        var hList = [],\n            sList = [],\n            vList = [];\n\n        var k = number\n        for (k; k > 0; k--) {\n\n            var offset = getNumberInNormalDistribution(std_dev)\n\n            var new_h = colors[n][0] + offset;\n            var new_s = colors[n][1] + offset;\n            var new_v = colors[n][2] + offset;\n\n            if (new_h < 0) {\n                new_h = 360 + new_h\n            } else if (new_h > 360) {\n                new_h = new_h - 360\n            }\n\n            if (new_s < 0) {\n                new_s = new_s * -1\n            } else if (new_s > 100) {\n                new_s = 200 - new_s\n            }\n\n            if (new_v < 0) {\n                new_v = new_v * -1\n            } else if (new_v > 100) {\n                new_v = 200 - new_v\n            }\n\n            hList.push(new_h)\n            sList.push(new_s)\n            vList.push(new_v)\n        }\n\n        colorList.push([hList, sList, vList])\n\n    }\n\n    var rgbList = []\n    let hIndex, sIndex, vIndex;\n    for (hIndex in colorList[0][0]) {\n        for (sIndex in colorList[0][1]) {\n            for (vIndex in colorList[0][2]) {\n\n                var RGBs = [];\n                for (n = 0; n < numberOfColor; n++) {\n                    RGBs.push(createRGBfromHSV(colorList[n][0][hIndex] / 360, colorList[n][1][sIndex] / 100, colorList[n][2][vIndex] / 100))\n                }\n                rgbList.push(RGBs)\n            }\n        }\n    }\n\n    return rgbList\n}\n\nvar posterIndex = 0\n\nvar backgroundPalette = [],\n    elementPalettePure = [],\n    elementPaletteGrad = [];\n\n//face_color/nose,ear_color/neck_color\nvar skinPalette = [\n    [{\n        r: 252,\n        g: 234,\n        b: 202\n    }, {\n        r: 240,\n        g: 216,\n        b: 182\n    }, {\n        r: 230,\n        g: 203,\n        b: 159\n    }],\n    [{\n        r: 245,\n        g: 219,\n        b: 174\n    }, {\n        r: 232,\n        g: 202,\n        b: 160\n    }, {\n        r: 218,\n        g: 189,\n        b: 141\n    }],\n    [{\n        r: 228,\n        g: 196,\n        b: 142\n    }, {\n        r: 214,\n        g: 178,\n        b: 133\n    }, {\n        r: 204,\n        g: 166,\n        b: 113\n    }]\n]\n\nvar colorRanNumber = 10,\n    colorRanRange = 5;\nbackgroundPalette.push(generateColor([\n    [0, 0, 100]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [0, 0, 92]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [0, 0, 21]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [164, 15, 72]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [248, 36, 58]\n], colorRanNumber, colorRanRange))\n\nbackgroundPalette.push(generateColor([\n    [39, 49, 98],\n    [331, 60, 96]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [328, 33, 100],\n    [213, 26, 100]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [187, 43, 100],\n    [325, 21, 100]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [171, 49, 91],\n    [223, 44, 89]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [336, 42, 100],\n    [222, 93, 60]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [36, 32, 99],\n    [188, 52, 95]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [135, 64, 91],\n    [259, 67, 96]\n], colorRanNumber, colorRanRange))\nbackgroundPalette.push(generateColor([\n    [8, 25, 98],\n    [188, 51, 85]\n], colorRanNumber, colorRanRange))\n\ncolorRanRange = 8\nelementPalettePure.push(generateColor([\n    [0, 0, 100]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [0, 0, 84]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [77, 13, 21]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [252, 59, 100]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [154, 37, 94]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [339, 40, 100]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [47, 78, 98]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [296, 59, 99]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [187, 45, 91]\n], colorRanNumber, colorRanRange))\nelementPalettePure.push(generateColor([\n    [347, 78, 100]\n], colorRanNumber, colorRanRange))\n\nelementPaletteGrad.push(generateColor([\n    [0, 0, 93],\n    [0, 0, 47]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [51, 19, 100],\n    [334, 45, 100]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [58, 83, 100],\n    [326, 80, 95]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [24, 49, 100],\n    [274, 79, 91]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [135, 64, 91],\n    [62, 81, 96]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [135, 64, 91],\n    [259, 67, 96]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [352, 42, 99],\n    [183, 75, 95]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [319, 86, 89],\n    [190, 46, 93]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [181, 80, 93],\n    [259, 67, 96]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [207, 86, 89],\n    [273, 82, 57]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [30, 11, 93],\n    [23, 44, 74]\n], colorRanNumber, colorRanRange))\nelementPaletteGrad.push(generateColor([\n    [187, 43, 100],\n    [325, 21, 100]\n], colorRanNumber, colorRanRange))\n\n//Rotation\n\nvar tRotation_1 = [0, 30, 60, 90, 120, 150, 180],\n    tRotation_2 = [0, 36, 72, 108, 144, 180],\n    tRotation_3 = [0, 30, 60, 90, 120, 150, 180],\n    tRotation_4 = [0, 180],\n    tRotation_5 = [0, 45, 90, 135, 180],\n    tRotation_6 = [0, 60, 90, 150, 180],\n    tRotation_7 = [0, 30, 60, 90, 120, 150, 180],\n\n    sRotation_1 = [0, 30, 60, 90, 120, 150, 180],\n    sRotation_2 = [0, 45, 90, 135, 180],\n\n    cRotation = [0, 45, 90, 135, 180];\n\n\n//Layout\n\nvar width = 240,\n    height = 240;\nvar fontSizeSmall = 5,\n    fontSizeMid = 8,\n    fontSizeLarge = 10;\n\n//resize\nwidth /= 2;\nheight /= 2;\nfontSizeSmall /= 2;\nfontSizeMid /= 2;\nfontSizeLarge /= 2;\n\n\nvar widthSegments = 15,\n    heightSegments = 20;\n\n//position for laying texts\nvar textIntersection = [];\ntextIntersection[0] = [(width / widthSegments) * 2, (height / heightSegments) * 2, 0]\ntextIntersection[1] = [(width / widthSegments) * 17, (height / heightSegments) * 2, 0]\ntextIntersection[2] = [(width / widthSegments) * 2, (height / heightSegments) * 32, 0]\ntextIntersection[3] = [(width / widthSegments) * 17, (height / heightSegments) * 32, 0]\n\nvar coreIntersections = [],\n    normalIntersections = [];\n\n//center\ncoreIntersections[0] = [width / 2, height / 2, 0];\n//three-folds\ncoreIntersections[1] = [width / 3, height / 3, 0];\ncoreIntersections[2] = [width / 3, height * 2 / 3, 0];\ncoreIntersections[3] = [width * 2 / 3, height / 3, 0];\ncoreIntersections[4] = [width * 2 / 3, height * 2 / 3, 0];\n//squre-intersection\ncoreIntersections[5] = calIntersection(height / width, 0, -width / height, width * width / height);\n//coreIntersections[5].push(Math.atan(-width/height)*90)\ncoreIntersections[5].push(0)\n\ncoreIntersections[6] = calIntersection(height / width, 0, -width / height, height)\n//coreIntersections[6].push(Math.atan(-width/height)*90)\ncoreIntersections[6].push(0)\n\ncoreIntersections[7] = calIntersection(-height / width, height, width / height, height - (width * width / height))\n//coreIntersections[7].push(Math.atan(width/height)*90)\ncoreIntersections[7].push(0)\n\ncoreIntersections[8] = calIntersection(-height / width, height, width / height, 0)\n//coreIntersections[8].push(Math.atan(width/height)*90)\ncoreIntersections[8].push(0)\n\nfunction calIntersection(a1, b1, a2, b2) {\n    var interPoint = []\n    //x\n    interPoint[0] = (b2 - b1) / (a1 - a2)\n    //y\n    interPoint[1] = a1 * interPoint[0] + b1\n    return interPoint\n}\n\n\n// Draw white points\n// var widthGap = width/widthSegments;\nvar heightGap = height / heightSegments;\n// var lineStyle_2 = {width: 0.5 ,color: '#C1BAC6'}\n\nfor (var i = 1; i < widthSegments; i++) {\n\n    var x = heightGap * i\n    //draw.line(x,0,x,height).stroke(lineStyle_2)\n\n    //calculate interaction with horizontal lines\n    normalIntersections.push([x, x * height / width, Math.atan(height / width) * 90])\n    normalIntersections.push([x, x * (-height / width) + height, Math.atan(-height / width) * 90])\n    normalIntersections.push([x, x * (-width / height) + width * width / height, Math.atan(-width / height) * 90])\n    normalIntersections.push([x, x * (-width / height) + height, Math.atan(-width / height) * 90])\n    normalIntersections.push([x, x * width / height + height - (width * width / height), Math.atan(width / height) * 90])\n    normalIntersections.push([x, x * width / height, Math.atan(width / height) * 90])\n}\nfor (var j = 1; j < heightSegments; j++) {\n    var y = heightGap * j\n    //draw.line(0,y,width,y).stroke(lineStyle_2)\n\n    normalIntersections.push([y / (height / width), y, Math.atan(height / width) * 90])\n    normalIntersections.push([(y - height) / (-height / width), y, Math.atan(-height / width) * 90])\n\n\n    if (y <= width * width / height) {\n        normalIntersections.push([(y - width * width / height) / (-width / height), y, Math.atan(-width / height) * 90])\n        normalIntersections.push([y / (width / height), y, Math.atan(width / height) * 90])\n    }\n\n    if (y >= height - width * width / height && y < height) {\n        normalIntersections.push([(y - height) / (-width / height), y, Math.atan(-width / height) * 90])\n        normalIntersections.push([(y - height + (width * width / height)) / (width / height), y, Math.atan(width / height) * 90])\n    }\n}\n\n// ==================================================================\n\nfunction loadxmlDoc(file) {\n    let xmlDoc;\n    try {\n        //IE\n        xmlDoc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n    } catch (e) {\n        ////Firefox, Mozilla, Opera, etc\n        xmlDoc = document.implementation.createDocument(\"\", \"\", null);\n    }\n\n    try {\n        xmlDoc.async = false;\n        xmlDoc.load(file);\n    } catch (e) {\n        // for Chrome\n        var xmlhttp = new window.XMLHttpRequest();\n        // console.log(xmlhttp);\n        xmlhttp.open(\"GET\", file, false);\n        xmlhttp.send(null);\n        xmlDoc = xmlhttp.responseXML.documentElement;\n        // Sconsole.log(xmlDoc);\n    }\n    return xmlDoc;\n}\n\nvar ob = loadxmlDoc(\"/all.xml\");\nvar svg = ob.getElementsByTagName(\"svg\");\n\n\n//create all possible shapes in the canvas\nfunction createShapes(cList, rList, tList, draw) {\n    for (var i = 0; i < svg.length; i++) {\n        var shape = draw.group()\n        let data;\n        if (svg[i].getElementById('triangle')) {\n            data = svg[i].getElementById('triangle').childNodes[1]\n            var transform = svg[i].getElementById('triangle').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n            var point = svg[i].getElementById('point')\n            var index = (parseInt(data.id.split(\"/\")[1]) + 4) + (parseInt(data.id.split(\"/\")[2]) + 4) * 9\n\n            // console.log(data.id)\n\n            //check if the element has transform data\n            if (svg[i].getElementById(data.id).getAttribute(\"transform\")) {\n                var elementTransform = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n                // console.log(elementTransform)\n                transform[0] = parseFloat(transform[0]) + parseFloat(elementTransform[0])\n                transform[1] = parseFloat(transform[1]) + parseFloat(elementTransform[1])\n\n                if (svg[i].getElementById(data.id).getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n                    var scaleValue = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',')\n                    shape.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]))\n                }\n            }\n\n            // set attributes of shape\n            if (point) {\n                var cx = parseFloat(point.getAttribute(\"x\"))\n                var cy = parseFloat(point.getAttribute(\"y\"))\n                shape.attr({\n                    \"name\": data.id,\n                    \"cx\": cx,\n                    \"cy\": cy,\n                    \"transform\": \"translate(\" + (parseFloat(transform[0]) - cx) + \",\" + (parseFloat(transform[1]) - cy) + \")\",\n                    \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                    \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n                })\n            } else {\n                shape.attr({\n                    \"name\": data.id,\n                    \"transform\": \"translate(\" + (parseFloat(transform[0]) - parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) - parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n                    \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                    \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n                })\n            }\n\n            // set content of shape\n            if (svg[i].getElementsByTagName('path')[0]) {\n                shape.path(svg[i].getElementsByTagName('path')[0].getAttribute(\"d\"))\n            } else if (svg[i].getElementsByTagName('polygon')[0]) {\n                shape.add(draw.polygon().attr(\"points\", svg[i].getElementsByTagName('polygon')[0].getAttribute(\"points\")))\n            }\n\n            draw.defs().add(shape)\n            tList[index] = shape\n\n\n        } else if (svg[i].getElementById('square')) {\n            data = svg[i].getElementById('square').childNodes[1]\n            var transform = svg[i].getElementById('square').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n            var point = svg[i].getElementById('point')\n            var index = (parseInt(data.id.split(\"/\")[1]) + 4) + (parseInt(data.id.split(\"/\")[2]) + 4) * 9\n\n\n            //check if the element has transform data\n            if (svg[i].getElementById(data.id).getAttribute(\"transform\")) {\n                var elementTransform = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n                // console.log(elementTransform)\n                transform[0] = parseFloat(transform[0]) + parseFloat(elementTransform[0])\n                transform[1] = parseFloat(transform[1]) + parseFloat(elementTransform[1])\n\n                if (svg[i].getElementById(data.id).getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n                    var scaleValue = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',')\n                    shape.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]))\n                }\n            }\n\n            // set attributes of shape\n            if (point) {\n                var cx = parseFloat(point.getAttribute(\"x\"))\n                var cy = parseFloat(point.getAttribute(\"y\"))\n                shape.attr({\n                    \"name\": data.id,\n                    \"cx\": cx,\n                    \"cy\": cy,\n                    \"transform\": \"translate(\" + (parseFloat(transform[0]) - cx) + \",\" + (parseFloat(transform[1]) - cy) + \")\",\n                    \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                    \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n                })\n            } else {\n                shape.attr({\n                    \"name\": data.id,\n                    \"transform\": \"translate(\" + (parseFloat(transform[0]) - parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) - parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n                    \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                    \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n                })\n            }\n\n            // set content of shape\n            if (svg[i].getElementsByTagName('path')[0]) {\n                shape.path(svg[i].getElementsByTagName('path')[0].getAttribute(\"d\"))\n            } else if (svg[i].getElementsByTagName('polygon')[0]) {\n                shape.add(draw.polygon().attr(\"points\", svg[i].getElementsByTagName('polygon')[0].getAttribute(\"points\")))\n            }\n\n            draw.defs().add(shape)\n            rList[index] = shape\n\n\n        } else if (svg[i].getElementById('circular')) {\n            data = svg[i].getElementById('circular').childNodes[1]\n            var transform = svg[i].getElementById('circular').getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n            var point = svg[i].getElementById('point')\n            var index = (parseInt(data.id.split(\"/\")[1]) + 4) + (parseInt(data.id.split(\"/\")[2]) + 4) * 9\n\n            //check if the element has transform data\n            if (svg[i].getElementById(data.id).getAttribute(\"transform\")) {\n                var elementTransform = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/[^\\(]+(?=\\))/g)[0].split(',')\n                // console.log(elementTransform)\n                transform[0] = parseFloat(transform[0]) + parseFloat(elementTransform[0])\n                transform[1] = parseFloat(transform[1]) + parseFloat(elementTransform[1])\n\n                if (svg[i].getElementById(data.id).getAttribute(\"transform\").indexOf(\"scale\") > 0) {\n                    var scaleValue = svg[i].getElementById(data.id).getAttribute(\"transform\").match(/scale.*?\\)/g)[0].match(/[^\\(]+(?=\\))/g)[0].split(',')\n                    shape.scale(parseInt(scaleValue[0]), parseInt(scaleValue[1]))\n                }\n            }\n\n            // set attributes of shape\n            if (point) {\n                var cx = parseFloat(point.getAttribute(\"x\"))\n                var cy = parseFloat(point.getAttribute(\"y\"))\n                shape.attr({\n                    \"name\": data.id,\n                    \"cx\": cx,\n                    \"cy\": cy,\n                    \"transform\": \"translate(\" + (parseFloat(transform[0]) - cx) + \",\" + (parseFloat(transform[1]) - cy) + \")\",\n                    \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                    \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n                })\n            } else {\n                shape.attr({\n                    \"name\": data.id,\n                    \"transform\": \"translate(\" + (parseFloat(transform[0]) - parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]) / 2) + \",\" + (parseFloat(transform[1]) - parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0]) / 2) + \")\",\n                    \"width\": parseFloat(svg[i].getAttribute(\"width\").match(/\\d+/g)[0]),\n                    \"height\": parseFloat(svg[i].getAttribute(\"height\").match(/\\d+/g)[0])\n                })\n            }\n\n            // set content of shape\n            if (svg[i].getElementsByTagName('path')[0]) {\n                shape.path(svg[i].getElementsByTagName('path')[0].getAttribute(\"d\"))\n            } else if (svg[i].getElementsByTagName('ellipse')[0]) {\n                shape.add(draw.ellipse().attr({\n                    \"cx\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"cx\"),\n                    \"cy\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"cy\"),\n                    \"rx\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"rx\"),\n                    \"ry\": svg[i].getElementsByTagName('ellipse')[0].getAttribute(\"ry\")\n                }))\n            } else if (svg[i].getElementsByTagName('circle')[0]) {\n                shape.add(draw.circle().attr({\n                    \"cx\": svg[i].getElementsByTagName('circle')[0].getAttribute(\"cx\"),\n                    \"cy\": svg[i].getElementsByTagName('circle')[0].getAttribute(\"cy\"),\n                    \"r\": svg[i].getElementsByTagName('circle')[0].getAttribute(\"r\")\n                }))\n            }\n\n            draw.defs().add(shape)\n            cList[index] = shape\n\n        }\n    }\n\n}\n\nvar drawList = []\n\n//Define the number of deatures for each shape\n// const NUM_SHAPE_FEATURES=15,\n// \t  MAX_ELEMENTS = 18,\n// \t  NUM_PEOPLE_FEATURES = 17,\n// \t  NUM_TEXT_FEATURES =1,\n// \t  NUM_BG_FEATURES = 6;\nconst NUM_ELEMENT_TYPE = 3,\n    NUM_ELEMENT_X = 9,\n    NUM_ELEMENT_Y = 9;\n\n\nfunction rotate(shape, index) {\n    var randomRotation = index\n    var shapeName = shape.node.attributes.name.nodeValue.split(\"/\")\n    var rotationAngel\n\n    if (shapeName[0] === \"t\") {\n        if (parseInt(shapeName[1]) === -4) {\n            rotationAngel = tRotation_1[parseInt(tRotation_1.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) === -3) {\n            rotationAngel = tRotation_2[parseInt(tRotation_2.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) === -2 || parseInt(shapeName[1]) === -1 || parseInt(shapeName[1]) === 0) {\n            rotationAngel = tRotation_3[parseInt(tRotation_3.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) === 1) {\n            rotationAngel = tRotation_4[parseInt(tRotation_4.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) === 2) {\n            rotationAngel = tRotation_5[parseInt(tRotation_5.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) === 3) {\n            rotationAngel = tRotation_6[parseInt(tRotation_6.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) === 4) {\n            rotationAngel = tRotation_7[parseInt(tRotation_7.length * randomRotation)]\n        }\n\n    }\n    //\n    else if (shapeName[0] === \"s\") {\n        if (parseInt(shapeName[1]) >= -4 && parseInt(shapeName[1]) <= -1) {\n            rotationAngel = sRotation_1[parseInt(sRotation_1.length * randomRotation)]\n        } else if (parseInt(shapeName[1]) >= 0 && parseInt(shapeName[1]) <= 4) {\n            rotationAngel = sRotation_2[parseInt(sRotation_2.length * randomRotation)]\n        }\n    } else if (shapeName[0] === \"c\") {\n        rotationAngel = cRotation[parseInt(cRotation.length * randomRotation)]\n    }\n\n    if (shape.attr(\"cx\") && shape.attr(\"cy\")) {\n        shape\n            .rotate(rotationAngel, shape.attr(\"cx\"), shape.attr(\"cy\"))\n    } else {\n        shape\n            .rotate(rotationAngel)\n    }\n\n    return randomRotation;\n}\n\nvar div = document.createElement(\"div\");\ndiv.setAttribute(\"id\", \"container\");\n\n// 被选中的海报\nvar choosed = null;\n\nvar _draw = SVG('test').size(width, height)\nvar _circleList = [], _rectList = [], _triList = [];\ncreateShapes(_circleList,_rectList,_triList,_draw)\n\n\nfunction zoomPoster(csvdata){\n    var draw = SVG(\"choosed\").size(width, height)\n\n    var circleList = _circleList.concat(),\n        rectList = _rectList.concat(),\n        triList = _triList.concat();\n\n    var shapeList = triList.concat(rectList, circleList);\n\n    var bgGradient = draw.gradient('linear', function (stop) {\n        var bgHSV = csvdata[csvdata.length - 1]\n        stop.at(0, createRGBfromHSV(bgHSV.data[0], bgHSV.data[1], bgHSV.data[2]))\n        stop.at(1, createRGBfromHSV(bgHSV.data[3], bgHSV.data[4], bgHSV.data[5]))\n    })\n    bgGradient.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n    draw.rect(width, height).fill(bgGradient)\n    // let start = new Date().getTime();\n    for (var i = 0; i < csvdata.length; i++) {\n        if (csvdata[i].name === \"element\") {\n            var shapeNormalX = Math.round((NUM_ELEMENT_TYPE - 1) * csvdata[i].data[0]),\n                shapeNormalY = Math.round((NUM_ELEMENT_X - 1) * csvdata[i].data[1]),\n                shapeNormalZ = Math.round((NUM_ELEMENT_Y - 1) * csvdata[i].data[2]);\n\n            var elementColor = draw.gradient('linear', function (stop) {\n                stop.at(0, createRGBfromHSV(csvdata[i].data[7], csvdata[i].data[8], csvdata[i].data[9]))\n                stop.at(1, createRGBfromHSV(csvdata[i].data[10], csvdata[i].data[11], csvdata[i].data[12]))\n            })\n            elementColor.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n\n            var shapeNormal = shapeList[shapeNormalX * NUM_ELEMENT_X * NUM_ELEMENT_Y + NUM_ELEMENT_X * shapeNormalY + shapeNormalZ].clone()\n\n            var shapeScale = Math.sqrt((width * height) * csvdata[i].data[3] / (shapeNormal.width() * shapeNormal.height()))\n\n            draw.use(shapeNormal)\n\n            shapeNormal\n                .dx(width * csvdata[i].data[4])\n                .dy(height * csvdata[i].data[5])\n\n            rotate(shapeNormal, csvdata[i].data[6])\n\n            shapeNormal\n                .scale(shapeScale, shapeScale)\n                .fill(elementColor)\n                .opacity(parseFloat(csvdata[i].data[13]))\n        }\n    }\n    draw.scale(550/120)\n    draw.translate(200,200)\n\n}\n\nfunction favPoster(csvdata,num) {\n    // var subdiv = document.createElement(\"div\");\n    // subdiv.setAttribute(\"id\", \"poster\"+num);\n    // subdiv.setAttribute(\"class\", \"poster\");\n    // div.appendChild(subdiv)\n    // document.body.appendChild(div);\n    // console.log(pnt.state);\n    var draw = SVG('favorite'+num).size(width, height)\n\n    var circleList = _circleList.concat(),\n        rectList = _rectList.concat(),\n        triList = _triList.concat();\n\n    var shapeList = triList.concat(rectList, circleList);\n\n    var bgGradient = draw.gradient('linear', function (stop) {\n        var bgHSV = csvdata[csvdata.length - 1]\n        stop.at(0, createRGBfromHSV(bgHSV.data[0], bgHSV.data[1], bgHSV.data[2]))\n        stop.at(1, createRGBfromHSV(bgHSV.data[3], bgHSV.data[4], bgHSV.data[5]))\n    })\n    bgGradient.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n    draw.rect(width, height).fill(bgGradient)\n    // let start = new Date().getTime();\n    for (var i = 0; i < csvdata.length; i++) {\n        if (csvdata[i].name === \"element\") {\n            var shapeNormalX = Math.round((NUM_ELEMENT_TYPE - 1) * csvdata[i].data[0]),\n                shapeNormalY = Math.round((NUM_ELEMENT_X - 1) * csvdata[i].data[1]),\n                shapeNormalZ = Math.round((NUM_ELEMENT_Y - 1) * csvdata[i].data[2]);\n\n            var elementColor = draw.gradient('linear', function (stop) {\n                stop.at(0, createRGBfromHSV(csvdata[i].data[7], csvdata[i].data[8], csvdata[i].data[9]))\n                stop.at(1, createRGBfromHSV(csvdata[i].data[10], csvdata[i].data[11], csvdata[i].data[12]))\n            })\n            elementColor.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n\n            // console.log(shapeList)\n            // console.log(shapeNormalX,shapeNormalY,shapeNormalZ,shapeNormalX*NUM_ELEMENT_X*NUM_ELEMENT_Y+NUM_ELEMENT_X*shapeNormalY+shapeNormalZ)\n\n            var shapeNormal = shapeList[shapeNormalX * NUM_ELEMENT_X * NUM_ELEMENT_Y + NUM_ELEMENT_X * shapeNormalY + shapeNormalZ].clone()\n\n            var shapeScale = Math.sqrt((width * height) * csvdata[i].data[3] / (shapeNormal.width() * shapeNormal.height()))\n\n            draw.use(shapeNormal)\n\n            // console.log(width*csvdata[i].data[4],height*csvdata[i].data[5],shapeScale,parseFloat(csvdata[i].data[13]))\n\n            shapeNormal\n                .dx(width * csvdata[i].data[4])\n                .dy(height * csvdata[i].data[5])\n\n            rotate(shapeNormal, csvdata[i].data[6])\n\n            shapeNormal\n                .scale(shapeScale, shapeScale)\n                .fill(elementColor)\n                .opacity(parseFloat(csvdata[i].data[13]))\n        }\n    }\n}\n\n// 生成海报，并为每一张海报添加click函数\nfunction createPoster(csvdata, num, isExtended) {\n\n    // var subdiv = document.createElement(\"div\");\n    // subdiv.setAttribute(\"id\", \"poster\"+num);\n    // subdiv.setAttribute(\"class\", \"poster\");\n    // div.appendChild(subdiv)\n    // document.body.appendChild(div);\n    // console.log(pnt.state);\n    if(isExtended)\n        var draw = SVG('square'+num).size(width, height)\n    else\n        var draw = SVG('poster'+num).size(width, height)\n\n    var circleList = _circleList.concat(),\n        rectList = _rectList.concat(),\n        triList = _triList.concat();\n\n    var shapeList = triList.concat(rectList, circleList);\n\n    var bgGradient = draw.gradient('linear', function (stop) {\n        var bgHSV = csvdata[csvdata.length - 1]\n        stop.at(0, createRGBfromHSV(bgHSV.data[0], bgHSV.data[1], bgHSV.data[2]))\n        stop.at(1, createRGBfromHSV(bgHSV.data[3], bgHSV.data[4], bgHSV.data[5]))\n    })\n    bgGradient.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n    draw.rect(width, height).fill(bgGradient)\n    // let start = new Date().getTime();\n    for (var i = 0; i < csvdata.length; i++) {\n        if (csvdata[i].name === \"element\") {\n            var shapeNormalX = Math.round((NUM_ELEMENT_TYPE - 1) * csvdata[i].data[0]),\n                shapeNormalY = Math.round((NUM_ELEMENT_X - 1) * csvdata[i].data[1]),\n                shapeNormalZ = Math.round((NUM_ELEMENT_Y - 1) * csvdata[i].data[2]);\n\n            var elementColor = draw.gradient('linear', function (stop) {\n                stop.at(0, createRGBfromHSV(csvdata[i].data[7], csvdata[i].data[8], csvdata[i].data[9]))\n                stop.at(1, createRGBfromHSV(csvdata[i].data[10], csvdata[i].data[11], csvdata[i].data[12]))\n            })\n            elementColor.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n\n            // console.log(shapeList)\n            // console.log(shapeNormalX,shapeNormalY,shapeNormalZ,shapeNormalX*NUM_ELEMENT_X*NUM_ELEMENT_Y+NUM_ELEMENT_X*shapeNormalY+shapeNormalZ)\n\n            var shapeNormal = shapeList[shapeNormalX * NUM_ELEMENT_X * NUM_ELEMENT_Y + NUM_ELEMENT_X * shapeNormalY + shapeNormalZ].clone()\n\n            var shapeScale = Math.sqrt((width * height) * csvdata[i].data[3] / (shapeNormal.width() * shapeNormal.height()))\n\n            draw.use(shapeNormal)\n\n            // console.log(width*csvdata[i].data[4],height*csvdata[i].data[5],shapeScale,parseFloat(csvdata[i].data[13]))\n\n            shapeNormal\n                .dx(width * csvdata[i].data[4])\n                .dy(height * csvdata[i].data[5])\n\n            rotate(shapeNormal, csvdata[i].data[6])\n\n            shapeNormal\n                .scale(shapeScale, shapeScale)\n                .fill(elementColor)\n                .opacity(parseFloat(csvdata[i].data[13]))\n        }\n    }\n    // console.log('for:')\n    // console.log(new Date().getTime()-start);\n    // drawList.push(draw);\n    // draw.attr('num', num);\n    // draw.click(function () {\n    //     //document.getElementById(\"audio-click\").play();\n    //\n    //     // 点击海报则放大显示\n    //     document.getElementById('chooseposter').style.display = 'block';\n    //     document.getElementById('overlay0').style.display = 'block';\n    //     if (choosed === null)\n    //         choosed = SVG(\"choosed\").fill('#0f4');\n    //     choosed.svg(draw.svg());\n    //     choosed.attr({\n    //         'num': num\n    //     });\n    //     choosed.scale(4.92);\n    //     choosed.translate(1294, 1559);\n    //     // pnt.setState({\n    //     //     num: draw.attr('num')\n    //     // });\n    //\n    //     // 添加放大动画\n    //     $(\"#chooseposter\").addClass(\"choose-poster-ani\");\n    // })\n}\n\n\nfunction setChoosedNull() {\n    choosed = null;\n}\n\n// // 生成“输入名字”页面的卡片上的海报\n// function createCardPoster(csvdata) {\n//     width *= 4.92;\n//     height *= 4.92;\n//     fontSizeSmall *= 4.92;\n//     fontSizeMid *= 4.92;\n//     fontSizeLarge *= 4.92;\n//     var draw = SVG('cardPoster').size(width, height);\n//\n//     // var circleList = _circleList.concat(), rectList = _rectList.concat(), triList = _triList.concat(), peopleList = _peopleList.concat()\n//     var circleList = [],\n//         rectList = [],\n//         triList = [];\n//\n//     createShapes(circleList, rectList, triList, draw)\n//\n//     var shapeList = triList.concat(rectList, circleList)\n//\n//     var bgGradient = draw.gradient('linear', function (stop) {\n//         var bgHSV = csvdata[csvdata.length - 1]\n//         stop.at(0, createRGBfromHSV(bgHSV.data[0], bgHSV.data[1], bgHSV.data[2]))\n//         stop.at(1, createRGBfromHSV(bgHSV.data[3], bgHSV.data[4], bgHSV.data[5]))\n//     })\n//     bgGradient.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n//     draw.rect(width, height).fill(bgGradient)\n//     // let start = new Date().getTime();\n//     for (var i = 0; i < csvdata.length; i++) {\n//         if (csvdata[i].name === \"element\") {\n//             var shapeNormalX = Math.round((NUM_ELEMENT_TYPE - 1) * csvdata[i].data[0]),\n//                 shapeNormalY = Math.round((NUM_ELEMENT_X - 1) * csvdata[i].data[1]),\n//                 shapeNormalZ = Math.round((NUM_ELEMENT_Y - 1) * csvdata[i].data[2]);\n//\n//             var elementColor = draw.gradient('linear', function (stop) {\n//                 stop.at(0, createRGBfromHSV(csvdata[i].data[7], csvdata[i].data[8], csvdata[i].data[9]))\n//                 stop.at(1, createRGBfromHSV(csvdata[i].data[10], csvdata[i].data[11], csvdata[i].data[12]))\n//             })\n//             elementColor.from(\"0%\", \"0%\").to(\"0%\", \"100%\")\n//\n//             // console.log(shapeList)\n//             //console.log(shapeNormalX,shapeNormalY,shapeNormalZ,shapeNormalX*NUM_ELEMENT_X*NUM_ELEMENT_Y+NUM_ELEMENT_X*shapeNormalY+shapeNormalZ)\n//\n//             var shapeNormal = shapeList[shapeNormalX * NUM_ELEMENT_X * NUM_ELEMENT_Y + NUM_ELEMENT_X * shapeNormalY + shapeNormalZ].clone()\n//\n//             var shapeScale = Math.sqrt((width * height) * csvdata[i].data[3] / (shapeNormal.width() * shapeNormal.height()))\n//\n//             draw.use(shapeNormal)\n//\n//             // console.log(width*csvdata[i].data[4],height*csvdata[i].data[5],shapeScale,parseFloat(csvdata[i].data[13]))\n//\n//             shapeNormal\n//                 .dx(width * csvdata[i].data[4])\n//                 .dy(height * csvdata[i].data[5])\n//\n//             rotate(shapeNormal, csvdata[i].data[6])\n//\n//             shapeNormal\n//                 .scale(shapeScale, shapeScale)\n//                 .fill(elementColor)\n//                 .opacity(parseFloat(csvdata[i].data[13]))\n//         }\n//     }\n//\n// }\n\nvar posterList = [];\nvar div;\n// 获取到服务器返回的csv文件后的回调函数\n\nvar features = []\nvar features2 = []\nvar noises= []\nvar noises2 = []\n\n\nfunction constructPoster(featureData, isExtended){\n    for (var i = 0; i < featureData.length; i++) {\n        var element = {\n                \"data\": featureData[i].slice(0, 15),\n                \"index\": featureData[i][14],\n                \"name\": \"element\"\n            },\n            element2 = {\n                \"data\": featureData[i].slice(15, 30),\n                \"index\": featureData[i][29],\n                \"name\": \"element\"\n            },\n            element3 = {\n                \"data\": featureData[i].slice(30, 45),\n                \"index\": featureData[i][44],\n                \"name\": \"element\"\n            },\n            element4 = {\n                \"data\": featureData[i].slice(45, 60),\n                \"index\": featureData[i][59],\n                \"name\": \"element\"\n            },\n            element5 = {\n                \"data\": featureData[i].slice(60, 75),\n                \"index\": featureData[i][74],\n                \"name\": \"element\"\n            },\n            element6 = {\n                \"data\": featureData[i].slice(75, 90),\n                \"index\": featureData[i][89],\n                \"name\": \"element\"\n            },\n            element7 = {\n                \"data\": featureData[i].slice(90, 105),\n                \"index\": featureData[i][104],\n                \"name\": \"element\"\n            },\n            element8 = {\n                \"data\": featureData[i].slice(105, 120),\n                \"index\": featureData[i][119],\n                \"name\": \"element\"\n            },\n            element9 = {\n                \"data\": featureData[i].slice(120, 135),\n                \"index\": featureData[i][134],\n                \"name\": \"element\"\n            },\n            element10 = {\n                \"data\": featureData[i].slice(135, 150),\n                \"index\": featureData[i][149],\n                \"name\": \"element\"\n            },\n            element11 = {\n                \"data\": featureData[i].slice(150, 165),\n                \"index\": featureData[i][164],\n                \"name\": \"element\"\n            },\n            element12 = {\n                \"data\": featureData[i].slice(165, 180),\n                \"index\": featureData[i][179],\n                \"name\": \"element\"\n            },\n            element13 = {\n                \"data\": featureData[i].slice(180, 195),\n                \"index\": featureData[i][194],\n                \"name\": \"element\"\n            },\n            element14 = {\n                \"data\": featureData[i].slice(195, 210),\n                \"index\": featureData[i][209],\n                \"name\": \"element\"\n            },\n            element15 = {\n                \"data\": featureData[i].slice(210, 225),\n                \"index\": featureData[i][224],\n                \"name\": \"element\"\n            },\n            element16 = {\n                \"data\": featureData[i].slice(225, 240),\n                \"index\": featureData[i][239],\n                \"name\": \"element\"\n            },\n            element17 = {\n                \"data\": featureData[i].slice(240, 255),\n                \"index\": featureData[i][254],\n                \"name\": \"element\"\n            },\n            element18 = {\n                \"data\": featureData[i].slice(255, 270),\n                \"index\": featureData[i][269],\n                \"name\": \"element\"\n            },\n            bg = {\n                \"data\": featureData[i].slice(270, 276),\n                \"name\": \"bg\"\n            };\n\n        var poster = [element, element2, element3, element4, element5, element6, element7, element8, element9, element10, element11,\n            element12, element13, element14, element15, element16, element17, element18, bg]\n\n        createPoster(poster, i, isExtended)\n\n        posterList.push(poster);\n    }\n}\n\nfunction constructPoster2(featureData){\n    var element = {\n            \"data\": featureData.slice(0, 15),\n            \"index\": featureData[14],\n            \"name\": \"element\"\n        },\n        element2 = {\n            \"data\": featureData.slice(15, 30),\n            \"index\": featureData[29],\n            \"name\": \"element\"\n        },\n        element3 = {\n            \"data\": featureData.slice(30, 45),\n            \"index\": featureData[44],\n            \"name\": \"element\"\n        },\n        element4 = {\n            \"data\": featureData.slice(45, 60),\n            \"index\": featureData[59],\n            \"name\": \"element\"\n        },\n        element5 = {\n            \"data\": featureData.slice(60, 75),\n            \"index\": featureData[74],\n            \"name\": \"element\"\n        },\n        element6 = {\n            \"data\": featureData.slice(75, 90),\n            \"index\": featureData[89],\n            \"name\": \"element\"\n        },\n        element7 = {\n            \"data\": featureData.slice(90, 105),\n            \"index\": featureData[104],\n            \"name\": \"element\"\n        },\n        element8 = {\n            \"data\": featureData.slice(105, 120),\n            \"index\": featureData[119],\n            \"name\": \"element\"\n        },\n        element9 = {\n            \"data\": featureData.slice(120, 135),\n            \"index\": featureData[134],\n            \"name\": \"element\"\n        },\n        element10 = {\n            \"data\": featureData.slice(135, 150),\n            \"index\": featureData[149],\n            \"name\": \"element\"\n        },\n        element11 = {\n            \"data\": featureData.slice(150, 165),\n            \"index\": featureData[164],\n            \"name\": \"element\"\n        },\n        element12 = {\n            \"data\": featureData.slice(165, 180),\n            \"index\": featureData[179],\n            \"name\": \"element\"\n        },\n        element13 = {\n            \"data\": featureData.slice(180, 195),\n            \"index\": featureData[194],\n            \"name\": \"element\"\n        },\n        element14 = {\n            \"data\": featureData.slice(195, 210),\n            \"index\": featureData[209],\n            \"name\": \"element\"\n        },\n        element15 = {\n            \"data\": featureData.slice(210, 225),\n            \"index\": featureData[224],\n            \"name\": \"element\"\n        },\n        element16 = {\n            \"data\": featureData.slice(225, 240),\n            \"index\": featureData[239],\n            \"name\": \"element\"\n        },\n        element17 = {\n            \"data\": featureData.slice(240, 255),\n            \"index\": featureData[254],\n            \"name\": \"element\"\n        },\n        element18 = {\n            \"data\": featureData.slice(255, 270),\n            \"index\": featureData[269],\n            \"name\": \"element\"\n        },\n        bg = {\n            \"data\": featureData.slice(270, 276),\n            \"name\": \"bg\"\n        };\n\n    var poster = [element, element2, element3, element4, element5, element6, element7, element8, element9, element10, element11,\n        element12, element13, element14, element15, element16, element17, element18, bg]\n\n    zoomPoster(poster)\n\n}\n\nfunction getDataCallback(data, containedNoise, isExtended, selectedID) {\n    // $.get(\"/test.csv\",function(data){\n    // console.log(data);\n    if(isExtended){\n        $(\".square2\").empty()\n        features2 = csv2array(data);\n\n        for(var f in features2){//\n            for(var g in features2[f]){\n                features2[f][g] = parseFloat(features2[f][g])\n            }\n            noises2[f] = features2[f].slice(0,39)\n            features2[f] = features2[f].slice(39)\n        }\n\n        if(selectedID){\n            for(var index in selectedID){\n                features2.push(features[selectedID[index]])\n            }   \n        }\n        constructPoster(features2,isExtended)\n\n    }else{\n        $(\".postersamples\").empty()\n        features = csv2array(data);\n        if(containedNoise){\n            for(var f in features){//\n                for(var g in features[f]){\n                    features[f][g] = parseFloat(features[f][g])\n                }\n                noises[f] = features[f].slice(0,39)\n                features[f] = features[f].slice(39)\n            }\n        }\n        else{\n            for(var f in features){//\n                for(var g in features[f]){\n                    features[f][g] = parseFloat(features[f][g])\n                }\n            }\n\n        }\n        constructPoster(features,isExtended)\n    }\n\n}\n\nfunction getfavorite(featureData) {\n    $(\"#favorite1, #favorite2, #favorite3, #favorite4\").empty()\n    for (var i = 0; i < featureData.length; i++) {\n        var element = {\n                \"data\": featureData[i].slice(0, 15),\n                \"index\": featureData[i][14],\n                \"name\": \"element\"\n            },\n            element2 = {\n                \"data\": featureData[i].slice(15, 30),\n                \"index\": featureData[i][29],\n                \"name\": \"element\"\n            },\n            element3 = {\n                \"data\": featureData[i].slice(30, 45),\n                \"index\": featureData[i][44],\n                \"name\": \"element\"\n            },\n            element4 = {\n                \"data\": featureData[i].slice(45, 60),\n                \"index\": featureData[i][59],\n                \"name\": \"element\"\n            },\n            element5 = {\n                \"data\": featureData[i].slice(60, 75),\n                \"index\": featureData[i][74],\n                \"name\": \"element\"\n            },\n            element6 = {\n                \"data\": featureData[i].slice(75, 90),\n                \"index\": featureData[i][89],\n                \"name\": \"element\"\n            },\n            element7 = {\n                \"data\": featureData[i].slice(90, 105),\n                \"index\": featureData[i][104],\n                \"name\": \"element\"\n            },\n            element8 = {\n                \"data\": featureData[i].slice(105, 120),\n                \"index\": featureData[i][119],\n                \"name\": \"element\"\n            },\n            element9 = {\n                \"data\": featureData[i].slice(120, 135),\n                \"index\": featureData[i][134],\n                \"name\": \"element\"\n            },\n            element10 = {\n                \"data\": featureData[i].slice(135, 150),\n                \"index\": featureData[i][149],\n                \"name\": \"element\"\n            },\n            element11 = {\n                \"data\": featureData[i].slice(150, 165),\n                \"index\": featureData[i][164],\n                \"name\": \"element\"\n            },\n            element12 = {\n                \"data\": featureData[i].slice(165, 180),\n                \"index\": featureData[i][179],\n                \"name\": \"element\"\n            },\n            element13 = {\n                \"data\": featureData[i].slice(180, 195),\n                \"index\": featureData[i][194],\n                \"name\": \"element\"\n            },\n            element14 = {\n                \"data\": featureData[i].slice(195, 210),\n                \"index\": featureData[i][209],\n                \"name\": \"element\"\n            },\n            element15 = {\n                \"data\": featureData[i].slice(210, 225),\n                \"index\": featureData[i][224],\n                \"name\": \"element\"\n            },\n            element16 = {\n                \"data\": featureData[i].slice(225, 240),\n                \"index\": featureData[i][239],\n                \"name\": \"element\"\n            },\n            element17 = {\n                \"data\": featureData[i].slice(240, 255),\n                \"index\": featureData[i][254],\n                \"name\": \"element\"\n            },\n            element18 = {\n                \"data\": featureData[i].slice(255, 270),\n                \"index\": featureData[i][269],\n                \"name\": \"element\"\n            },\n            bg = {\n                \"data\": featureData[i].slice(270, 276),\n                \"name\": \"bg\"\n            };\n\n        var poster = [element, element2, element3, element4, element5, element6, element7, element8, element9, element10, element11,\n            element12, element13, element14, element15, element16, element17, element18, bg]\n\n        favPoster(poster, i)\n\n    }\n\n}\n\nexport {\n    _circleList,\n    _rectList,\n    _triList,\n    height,\n    width,\n    features,\n    features2,\n    noises,\n    noises2\n};\n\nexport {\n    choosed,\n    posterList,\n    setChoosedNull\n};\n\nexport {\n    createPoster,\n    createShapes,\n    getDataCallback,\n    constructPoster2,\n    getfavorite\n};"]},"metadata":{},"sourceType":"module"}